/*! library-search-assist @version @0.0.0-68 @published Thu Jul 31 2014 11:21:33 GMT-0700 (PDT) @hex_t_stamp 6HYAESGZO*/
YUI.add("search-assist-advanced-suggestions-plugin",function(a){"use strict";var b,c=function(){c.superclass.constructor.apply(this,arguments)},d="suggest-markup-has-been-attached-to-DOM",e="zero-suggestions-rendered-to-DOM",f=function(a){this.suggestionText=a.suggestionText,this.label=a.label,this._generateMarkup()},g=function(a){this.value=a.value,this.label=a.label,this._generateMarkup()};f.prototype={_generateMarkup:function(){this.markup='<span class="'+this.cssClass+'">'+this.label+"</span>"},toString:function(){return this.suggestionText},cssClass:"site suggestionToken"},g.prototype={_generateMarkup:function(){this.markup='<span class="'+this.cssClass+'">'+this.label+"</span>"},toString:function(){return""},onSubmit:function(a){a.target.evtFacade.target.ancestor("form").append('<input type="hidden" name="vl" value="'+this.value+'"/>'),a.target.evtFacade.target.ancestor("form").append('<input type="hidden" name="fl" value="1"/>')},cssClass:"country suggestionToken"},b={database:{french:new g({suggestionText:"",value:"lang_fr",label:"in French"}),ebay:new f({suggestionText:"site:ebay.com",label:"Ebay.com"}),craigslist:new f({suggestionText:"site:craigslist.org",label:"Craigslist.org"}),amazon:new f({suggestionText:"site:amazon.com",label:"Amazon.com"}),zillow:new f({suggestionText:"site:zillow.com",label:"Zillow.com"}),cnn:new f({suggestionText:"site:cnn.com",label:"Cnn.com"}),mashable:new f({suggestionText:"site:mashable.com",label:"Mashable.com"}),reddit:new f({suggestionText:"site:reddit.com",label:"Reddit.com"})},getSuggestions:function(b){var c,d,e=a.Lang.trim(b),f=e.split(" "),g=f.length,h={suggestions:[],text:""};for(c=0;g>c;c++)d=this.database[f[c].toLowerCase()],d&&(f.splice(c,1),g--,c--,h.suggestions.push(d));return h.text=f.join(" "),h}},a.mix(c,{NAME:"search-assist-advanced-suggestions-plugin",NS:"AdvancedSuggestions",ATTRS:{}}),a.extend(c,a.Plugin.Base,{initializer:function(){a.log("instantiating the advanced Search plugin","debug"),this.doAfter(d,this._prependAdvancedSuggestions),this.doAfter(e,this._prependAdvancedSuggestions)},_prependAdvancedSuggestions:function(c){var d,e,f=this.get("host"),g=b.getSuggestions(c.query),h={markup:"",suggestionText:g.text+" ",prepend:!0},i=g.suggestions.length;for(d=0;i>d;d+=1)e=g.suggestions[d],h.markup+=e.markup+" ",h.suggestionText+=e+" ",e.onSubmit&&f.on("search-assist-form-submit",a.bind(e.onSubmit,e));g.suggestions.length&&(h.markup+=g.text,f.addSuggestion(h))}}),a.AdvancedSuggestionsPlugin=c},"1.0.0",{requires:["plugin","base-pluginhost"]}),YUI.add("search-assist-aria-plugin",function(a){"use strict";var b,c="suggest-markup-has-been-attached-to-DOM",d="search-assist-tray-removed",e="search-assist-suggestion-selected",f="sa-aria-live-region";b=function(){b.superclass.constructor.apply(this,arguments)},a.mix(b,{NAME:"search-assist-aria-plugin",NS:"aria",ATTRS:{suggestionBoxClosedText:{value:"Suggestion box closed"},newSuggestionsShownText:{setter:function(a){var b="";return b=a.trending?b+a.count+" new trending suggestions shown":b+a.count+" new suggestions shown"}},suggestionSelectedText:{setter:function(a){var b="";return a&&(b="suggestion selected, "+a+", press arrow-right key to autocomplete or, press enter to search"),b}}}}),a.extend(b,a.Plugin.Base,{initializer:function(){this.aria_plugin_subscr={};var b,g=this.get("host");a.log("instantiating the ARIA plugin #######################","debug"),g.get("quietMode")===!1&&g.get("searchBox").setAttribute("aria-haspopup",!0),this.aria_plugin_subscr.SA_ARIA_EVT_SUGGEST_MARKUP_RENDERED=this.doAfter(c,this._handleTrayHasBeenRendered),this.aria_plugin_subscr.EVT_SUGGESTIONS_HAS_BEEN_REMOVED=this.doAfter(d,this._handleTrayHasBeenRemoved),this.aria_plugin_subscr.EVT_SUGGESTION_SELECTED=this.doAfter(e,this._handleSuggestionSelected),b=this._liveRegion=a.Node.create('<div role="status" class="'+f+'" aria-live="polite"></div>'),this.aria_plugin_subscr.NODE_LIVE_REGION=b,b.setStyles({position:"absolute",left:"-9999px"}),a.one("body").append(b)},_handleTrayHasBeenRemoved:function(){this._liveRegion&&(this._liveRegion.setContent("<p>"+this.get("suggestionBoxClosedText")+"</p>"),this._liveRegion.setAttribute("aria-expanded","false"))},_handleTrayHasBeenRendered:function(b){var c,d,e=this.get("host"),f=e.get("tray"),g=f.Node,h=f.len;g&&(c=g.all("> ul"),d=g.all("> ul *"),a.Lang.isNumber(h)?(b.trending?(this.set("newSuggestionsShownText",{count:h,trending:!0}),this._liveRegion.setContent("<p>"+this.get("newSuggestionsShownText")+"</p>")):(this.set("newSuggestionsShownText",{count:h,trending:!1}),this._liveRegion.setContent("<p>"+this.get("newSuggestionsShownText")+"</p>")),this._liveRegion.setAttribute("aria-expanded","true")):this._liveRegion.setAttribute("aria-expanded","false"),c.each(function(a){a.setAttribute("role","listbox")}),d.each(function(a){a.setAttribute("role","option")}))},_handleSuggestionSelected:function(a){this._liveRegion&&a.suggestion&&(this.set("suggestionSelectedText",a.suggestion),this._liveRegion.setContent("<p>"+this.get("suggestionSelectedText")+"</p>"))},destroy:function(){var b,c=this.aria_plugin_subscr;if(c)for(b in c)c.hasOwnProperty(b)&&(a.log("aria: unplugging "+b,"debug"),a.Lang.isFunction(c[b].purge)&&c[b].purge(),a.Lang.isFunction(c[b].detach)&&c[b].detach(),a.Lang.isFunction(c[b].remove)&&c[b].remove(),delete c[b])}}),a.namespace("SEARCHASSIST").AriaPlugin=b},"1.0.0",{requires:["plugin","base-pluginhost"]}),YUI.add("search-assist-client",function(a,b){"use strict";var c="client",d="searchBox",e="searchForm",f="show-fake-box-hint",g=400,h=0,i=4,j=10,k=8,l=13,m=9,n=32,o=39,p=37,q=38,r=40,s=229,t=197,u="search-assist-form-submit",v="query-emptiness",w="valuechange",x="search-assist-new-confidence",y="search-assist-ghost-box-rendered",z="suggest-markup-has-been-attached-to-DOM",A="zero-suggestions-rendered-to-DOM";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"Sa-Client",ATTRS:{}}),a.SEARCHASSIST.CLIENT=a.Base.create(c,a.SEARCHASSIST.CORE,[a.SEARCHASSIST.TRAY,a.SEARCHASSIST.MOBILE,a.SEARCHASSIST.NAVIGATE,a.SEARCHASSIST.LINKTRACK],{clientInit:function(){this.publishClientEvts()},initializer:function(c){var e=this.get(d);a.log("instantiating CLIENT","debug",b),this.get("quietMode")||this.clientInit(c),this._confidence=0,this._prevSuggestion="",this._confidenceCounter=0,e&&e.hasAttribute("autofocus")&&e.focus()},setEventsForFakeBox:function(){var b=this,c=this.get(d),e=this._allSubscr||{};e._srchNodeKeyDownFakeBox=c.on("keydown",function(c){var d,e,f;!b.get("fakeBoxNode").get("value")||c.keyCode!==m&&c.keyCode!==o||(d=b.getQuery(),b.logAutoCompletion(d,b.get("fakeBoxNode").get("value"),1)),b.get("fakeBox")&&b.get("fakeBox").autoCompleteOnReturnKey&&c.keyCode===l&&b.get("fakeBoxNode").get("value")&&b.get("searchBox").set("value",b.get("fakeBoxNode").get("value")),a.UA.webkit&&c.keyCode===l&&b.get("fakeBox")&&(e=b.get("fakeBoxNode"),f=a.one("#fbdum"),e&&e.remove(),f&&f.remove())}),e._srchNodeKeyUpFakeBox=c.on("keyup",function(c){if(a.UA.webkit&&c.keyCode===l&&b.get("fakeBox")){var d=b.get("fakeBoxNode");d||b.get("ieTillEight")||b.initFakeBoxNode()}(c.keyCode===r||c.keyCode===q||c.keyCode===o||c.keyCode===p||c.keyCode===m)&&b.resetFBox()}),a.one("#fbdum").on("click",function(){b.resetFBox(),c.focus()}),this.on(A,function(){b.resetFBox()}),this.on(z,function(a){var c=a.firstSuggestion,d=a.query,e=this.get("fakeBoxNode");return e&&e.get("value")&&0!==e.get("value").indexOf(d,0)&&b.resetFBox(),""===d||b._prevSuggestion!==c.toLowerCase()?void b.resetFBox():void 0}),this.on(x,function(c){var d=c.query;""!==d&&(b.ghost&&b.ghost.cancel(),b.ghost=a.later(g,this,function(){b.ghostAutoComplete(c)}))}),c.on("click",function(){b.resetFBox()}),this.get("ieTillEight")||c.get("parentNode").on("click",function(){c.focus()})},initFakeBoxNode:function(){var a,b="fakeBox",c="fakeBoxHint",e=this.get(d),f='<div id="fbdum" style="position:absolute; left:0; right:0; top:0; bottom:0;z-index:-1"></div>',g='<input id="'+b+'"type="text" class="fakebox" aria-hidden="true" autocomplete="off" autocorrect="off" dir="ltr" />',h="",i=this.get("fakeBox").fakeBoxHintText;this.get("fakeBox").fakeBoxHint&&i&&i.length>0&&(h='<span id="'+c+'" class="fakeBoxHint">'+i+"</span>"),e.get("parentNode").append(g),e.get("parentNode").append(f),h&&e.get("parentNode").append(h),a=this.get("fakeBoxNode"),a.setStyles({"border-radius":e.getStyle("border-radius"),margin:e.getStyle("margin"),fontSize:e.getStyle("fontSize"),fontFamily:e.getStyle("fontFamily"),paddingLeft:e.getStyle("paddingLeft"),paddingRight:e.getStyle("paddingRight"),paddingTop:e.getStyle("paddingTop"),paddingBottom:e.getStyle("paddingBottom"),marginLeft:e.getStyle("marginLeft"),marginTop:e.getStyle("marginTop"),marginBottom:e.getStyle("marginBottom"),marginRight:e.getStyle("marginRight"),borderLeftWidth:e.getStyle("borderLeftWidth"),borderRightWidth:e.getStyle("borderRightWidth"),borderTopWidth:e.getStyle("borderTopWidth"),borderBottomWidth:e.getStyle("borderBottomWidth"),borderLeftStyle:e.getStyle("borderLeftStyle"),borderRightStyle:e.getStyle("borderRightStyle"),borderTopStyle:e.getStyle("borderTopStyle"),borderBottomStyle:e.getStyle("borderBottomStyle"),borderLeftColor:e.getStyle("borderLeftColor"),borderRightColor:e.getStyle("borderRightColor"),borderTopColor:e.getStyle("borderTopColor"),borderBottomColor:e.getStyle("borderBottomColor"),zIndex:"-1"}),a.blur(),a.setAttribute("disabled",!0),a.setAttribute("tabindex","-1"),e.setStyle("backgroundColor","transparent"),e.setAttribute("onfocus","this.value = this.value;")},initGhostBox:function(){this.get("ieTillEight")||this.get("fakeBoxNode")||(this.initFakeBoxNode(),this.setEventsForFakeBox())},initConfidence:function(){var b=this;this.on(z,function(c){var d=c.firstSuggestion,e=c.query;d&&e&&0===d.toLowerCase().indexOf(e.toLowerCase(),0)?(b._confidence=j-(d.length-e.length)/d.length*j,b._prevSuggestion===d.toLowerCase()?b._confidenceCounter<=j&&(b._confidenceCounter+=1):b._confidenceCounter=0,b._confidenceCounter>0&&(b._confidence+=b._confidenceCounter,b._confidence>=j&&(b._confidence=j))):(b._confidenceCounter=0,b._confidence=h),d&&(b._prevSuggestion=d.toLowerCase()),c._confidence=b._confidence,a.log("confidence of suggestion close to query: "+b._confidence,"debug"),b.fire(x,c)})},adjustCase:function(a,b){var c;return a&&b?c=a+b.substr(a.length):""},ghostAutoComplete:function(c){var e,g,h,j,k=this,l=this,m=this.get("fakeBoxNode"),n=this.get("fakeBoxHintNode"),o=k.getQuery(),p=o.toLowerCase(),q=20;return g=this._queryWidth,h=this.get(d).get("clientWidth")-l._sbxPadLeftInt,g>h-q?(a.log("textWidth:"+g+"greater than sbxWidth:"+h,"debug",b),void this.resetFBox()):(n&&(q=n.get("offsetWidth")+100),j=h-g,e=c.firstSuggestion,void(m&&""!==p&&!l.isTrayTypeTrending()&&this._confidence>i?(m.set("value",e),e=this.adjustCase(o,e),m.set("value",e),this.fire(y,c),e!==this.get("searchBox").get("value")&&this.resetTabTrack(),n&&(this._firsttimehint?q>j&&this.resetFBoxHint(!0):j>=q&&(n.addClass(f),this._firsttimehint=a.later(5e3,this,function(){n.removeClass(f)})))):this.resetFBox()))},resetFBoxHint:function(a){var b=this.get("fakeBoxNode"),c=this.get("fakeBoxHintNode");b&&c&&this._firsttimehint&&(this._firsttimehint.cancel(),c.removeClass(f),a||(this._firsttimehint=!1))},resetFBox:function(){var a=this.get("fakeBoxNode");a&&(a.set("value",""),a.blur())},registerBoxEvents:function(){var c,e=this,f=e.get(d),g=this,h=this,i=this,j=e.get("currentDevice"),l=this._allSubscr;"desktop"===j&&e.get("fakeBox")&&this.initGhostBox(),"desktop"===j&&this.initConfidence(),f?(a.log("searchNode is "+f,"debug",b),l._clientSrchNodeOnClick=f.on("click",function(c){a.log("click caught on searchnode","debug",b),e.get("mobileExpandMode")&&(c.stopPropagation(),c.preventDefault()),h.handleEventOnSearchBox(c,"click")}),this.get("gecko")&&(a.log("gecko user agent..","degug",b),c=function(){return g._geckoGeneralState?void(g._geckoGeneralState=!1):(g.fireInTheHole(),void(g._geckoGeneralState=!1))},l._clientSrchValChangeGecko=f.on("valueChange",function(b){var d,e;return g._grog&&g._grog.cancel(),g._geckoGeneralState?(g._geckoGeneralState=!1,g._valueChangeFail&&g._valueChangeFail.cancel(),void(g._valueChangeFail=a.later(100,this,function(){if(g._geckoCaughtKeyUp)g._geckoCaughtKeyUp=!1;else{if(g._geckoCharCodeOnKeyDown===q||g._geckoCharCodeOnKeyDown===r)return;g.fireInTheHole()}}))):(d=g._geckoCharCodeOnKeyDown,e=d===q||d===r||d===o||d===p||d===k||d===n,void(e||(g._grog=a.later(20,this,function(){c(b)}))))}),l._clientSrchKeyDownNativeGecko=f.on("keydown",function(a){g._geckoCharCodeOnKeyDown=a.charCode,g._geckoGeneralState=!0,g._geckoCaughtKeyUp=!1}),f.on("keyup",function(b){a.log("keyup: e.keyCode:"+b.keyCode,"debug"),g._geckoGeneralState=!0,g._geckoCaughtKeyUp=!0})),l._clientSrchKeyUpNative=f.on("keyup",function(b){return b.charCode===q||b.charCode===r||b.charCode===s||b.charCode===t?(a.log("arrow up / arrow down on keyup, as good as no keyup for native input case","debug"),void(g._nativeTrayKeyup=!1)):(g._nativeTrayKeyup=!0,void a.log("keyup: e.charCode:"+b.charCode,"debug"))}),l._clientSrchKeyDownNative=f.on("keydown",function(b){return g._nativeTrayKeyup=!1,a.log("keydown: e.keyCode:"+b.keyCode,"debug"),g._native!==!0||b.charCode!==n&&b.charCode!==s&&b.charCode!==t?(b.keyCode===t||b.keyCode===s?(a.log("keydown: input from native keyboard","debug"),g._native=!0):(g._native=!1,a.log("keydown: input from normal keyboard","debug")),void((b.charCode===r||b.charCode===q)&&(g._d=this.get("value")))):void a.log("native is already true and keypressed was either space or native input key","debug")}),l._clientSrchValChangeNative=f.on("valueChange",function(b){a.log("valueChange:"+b.newVal,"debug"),g._c=b.newVal,g._p=b.prevVal,g._s=this.get("value"),g._native&&g._nativeTrayKeyup===!1&&(a.log("updating tray","debug"),a.log("_nativeTrayKeyup:"+g._nativeTrayKeyup,"debug"),a.log("_native:"+g._native,"debug"),g.fireInTheHole())}),l._clientSrchValChange=f.on("valueChange",function(a){var b=a.newVal;""===b&&e.isTrendingEnabled()&&i.fireInTheHole(a)}),l._clientSrchNodeOnValueChange=f.on(w,function(c){a.log("event-value change was captured, self.keydown = "+i.getKeyDownState(),"debug",b);var d=g.getQuery();i.getKeyDownState()===!1&&""===d&&(a.log("firing query emptiness","debug",b),this.fire(v)),a.log("query wasnt empty on event-value-change","debug",b),h.handleEventOnSearchBox(c,w)})):a.log("srchNode not found","error",b)},publishClientEvts:function(){var c=this._allSubscr||{};a.log("publishing Client events","debug",b),a.log("registering box event","debug",b),this.registerBoxEvents(),c._eventFormSubmit=this.publish(u,{defaultFn:a.bind("_defEvtFormSubmit",this)})},_defEvtFormSubmit:function(){var b=this;this.get("preventFormSubmit")?a.log("*****************NOT submitting form ********************","debug"):(a.log("*****************************submitting form*******************","debug"),b.get(e).submit())},trimEndSpace:function(a){var b;if(a){for(a=a.replace(/^\s+/,""),b=a.length-1;b>=0;b-=1)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a}return null},setSearchBoxVal:function(a){var b=this,c=b.get(d);c&&c.set("value",a)},handleEventOnSearchBox:function(c,d){var e=this,f=this,g=this.getQuery(),h=this,i=this,j=h.get("currentDevice"),k=h.isTrendingEnabled();if("desktop"===j){if("click"===d){if(a.log("desktop:event:"+d,"debug",b),f.isTrayOpen())return;""===g?k&&e.fireInTheHole(c):e.fireInTheHole(c)}if("keyup"===d)return a.log("desktop:event:"+d,"debug",b),void(""===g?k&&e.fireInTheHole(c):e.fireInTheHole(c));if(d===w||d===v)return a.log("desktop:event:"+d,"debug",b),void(k?g&&""!==g||(a.log("query is empty","debug",b),this.resetFBoxHint(!1),e.getKeyDownState()===!1&&(f.isTrayOpen()&&f.isTrayTypeTrending()?a.log("trending tray already open","debug",b):e.fireInTheHole(c))):g&&""!==g||(this.resetFBoxHint(!1),f.isTrayOpen()&&f.removeSuggestionsMarkup()))}("phone"===j||"tablet"===j)&&i.handleMobileEventsOnSearchBox(c,d)},isStringEmpty:function(a){return a&&""!==a&&""!==this.trimEndSpace(a)?!1:!0},getQuery:function(){var a=this,b=a.get(d),c="";return b?(c=b.get("value"),this.isStringEmpty(c)?"":c):void 0},addSuggestion:function(a){var b=this;this.isRenderMode("tray")&&(a.mode="tray",b.addNewSuggestion(a))}})},"0.0.1",{requires:["search-assist","search-assist-tray","search-assist-mobile","search-assist-linktrack","search-assist-navigate","cache","base","node-base","jsonp","json-stringify","highlight-base","event-valuechange","escape","event-outside","event-flick","node-style","node-screen","json-stringify","cookie","datasource","datasource-jsonschema","datasource-xmlschema","datasource-arrayschema","dataschema"]}),YUI.add("search-assist-config-panel-plugin",function(a,b){"use strict";var c,d="sa-config-panel",e="sa-config-panel-wrapper",f="icon-wrench",g="icon-wrench-wrapper",h="icon-wrench-wrapper-active";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"search-assist-config-panel-plugin",NS:"configui",ATTRS:{title:{valueFn:function(){var b=a.Node.create('<div class="'+d+'-title"> SA Config panel</div>'),c=this.get("panel");return c.append(b),b.setStyles({background:"#fff",color:"#000",display:"block","border-bottom":"1px solid #ccc"}),a.one("."+d+"-title")}},panel:{valueFn:function(){var b=a.Node.create('<div class="'+d+'"></div>');return b.setStyles({display:"block",border:"1px solid #ccc",padding:"10px","box-shadow":"1px 2px 10px #ccc","border-radius":"2px",background:"#fff"}),b.hide(),a.one("body").prepend(b),a.one("."+d)}},origToShow:{valueFn:function(){return this.get("host").get("configPanel").toShow}},toShow:{valueFn:function(){var b,c=this.get("host"),d=c.get("configPanel").toShow,e=[],f=0;for(a.log(d,"debug"),b=d.length,f=0;b>f;f+=1)e[d[f]]=!0;return a.log(e,"debug"),e}}}}),a.extend(c,a.Plugin.Base,{initializer:function(){this.config_plugin_subscr={},a.log("instantiating the config plugin #######################","debug"),this.isPanelHidden=!0;var b,c,i=this,j=this.get("origToShow"),k=a.one("."+d);a.Array.each(j,function(a){var b=i.createCheckBox(a);b&&i.setCheckBox(b,a)}),this.config_plugin_subscr.configTitle=this.get("title"),this.config_plugin_subscr.panelWrapper=c=a.Node.create('<div class="'+e+'"></div>'),this.config_plugin_subscr.wrench=b=a.Node.create('<div class="'+g+'"></div>'),this.config_plugin_subscr.configPanel=k,b.setHTML('<span><i class="'+f+'">setting</i></span>'),k.wrap(c),c.prepend(b),c.setStyles({display:"inline-block",position:"fixed",right:"0","z-index":"2000"}),b.setStyles({display:"block",cursor:"pointer",padding:"5px",color:"#bbb","font-size":"1.0em","float":"right"}),b.on("click",function(){i.isPanelHidden?(this.addClass(h),k.show(),i.isPanelHidden=!1):(k.hide(),this.removeClass(h),i.isPanelHidden=!0)})},createCheckBox:function(b){var c,e,f=this.get("panel"),g=this.get("host");return void 0===g.get(b)?(a.log('invalid param name provided in configpanel array ["'+b+'"]',"error"),null):this.get("toShow")[b]?(c=this.config_plugin_subscr.param=a.Node.create('<input type="checkbox" class="'+d+"-"+b+'"" name="'+b+'" value="0">'),f.append(c),e=a.one("."+d+"-"+b),e.wrap('<div class="'+b+'-wrapper"></div>'),a.one("."+b+"-wrapper").append("<span>"+b+"</span>"),e):void 0},setCheckBox:function(a,b){var c=this.get("host"),d=c.get(b);d?a.set("checked",!0):a.set("checked",!1),this.config_plugin_subscr=a.on("click",function(){c.set(b,this.get("checked"))})},destroy:function(){var c,d=this.config_plugin_subscr;if(d)for(c in d)d.hasOwnProperty(c)&&(a.log("unplugging "+c,"debug",b),a.Lang.isFunction(d[c].purge)&&d[c].purge(),a.Lang.isFunction(d[c].detach)&&d[c].detach(),a.Lang.isFunction(d[c].remove)&&d[c].remove(),delete d[c])}}),a.SEARCHASSIST.SaConfigUIPlugin=c},"1.0.0",{requires:["plugin","base-pluginhost"]}),YUI.add("search-assist-core",function(a,b){"use strict";var c="core",d=200,e=8e5,f=2,g="bck",h="t_stmp",i="csrcpvid",j="vtestid",k="mtestid",l="spaceId",m="response-received",n="no-response-received";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"Sa-Core",ATTRS:{}}),a.SEARCHASSIST.CORE=a.extend(c,a.SEARCHASSIST,{coreInit:function(){this.initCache(),this._totalHitsToCache=0,this._totalHitsToSuggestServer=0,this.get("_externalDS")&&this.initExternalDS()},initializer:function(c){a.log("instantiating CORE","debug",b),this.get("quietMode")||this.coreInit(c)},initCache:function(){this.get("allowCache")&&(this.myCache=new a.Cache({max:d,expires:e}),a.log("====Cache has been initialized====","debug",b))},flushCache:function(){this.get("allowCache")&&this.myCache&&(this.myCache.flush(),a.log("=====cache was flushed=====","debug",b))},initExternalDS:function(){var b=this.get("_externalDS"),c=b.params,d=b.url,e=c.schema;this.validateSchema(e),this._DS=new a.DataSource.Get({source:d})},validateSchema:function(b){try{if(!b)throw a.error("No schema specified");if(!b.resultListLocator)throw a.error("No resultListLocator field inside schema"+a.JSON.stringify(b,null,"     "));if(!b.resultFields||!b.resultFields[0])return this._noFields=!0,void a.log("no resultFields found","warn");if(!b.resultFields[0].key)throw a.error('No "key" param inside schema for resultFields"'+a.JSON.stringify(b,null,"     "));this._noFields=!1,this.set("_suggArrayParam",b.resultFields[0].key)}catch(c){a.log("schema "+c,"error")}},getNormalizedData:function(a,b,c){var d,e=this,f=this.get("allowCache");return d=this.getNormalizedJson(a,b,c),f&&e.myCache.add(c,d,c),d},handleNoFieldsInSchema:function(c){var d,e,f=this,g=f.getDefaultSuggArrParam(),h=c.results;for(a.log("Expecting resultListLocator to contain suggestions as raw array data with no objects inside","warn",b),this.set("_suggArrayParam",g),d=0;d<h.length;d+=1){if(a.Lang.isObject(h[d]))return a.error("When no resultFields are specified, the listlocator is assumed to be a pure array"),c;e={},e[g]=h[d],c.results[d]=e}return c},handleCustomData:function(b,c){var d,e,f=this.get("_externalDS"),g=b.typedData||"",h=f.params,i=h.custom,j=h.schema,k=this;return e=a.Lang.isFunction(i.data)?i.data(g):a.clone(i.data),j=h.schema,d=k.getNormalizedData(e,j,g),c(d)},handleExternalDS:function(a,b){var c=this.get("_externalDS");return c.params.custom?this.handleCustomData(a,b):this.handleJsonReqest(a,b)},getNormalizedJson:function(b,c){var d,e=this;return this.validateSchema(c),a.log("=====data from server======","info"),a.log(a.JSON.stringify(b,null,"   "),"info"),a.log("=====schema provided======","info"),a.log(a.JSON.stringify(c,null,"    "),"info"),d=a.DataSchema.JSON.apply(c,b),e._noFields&&(d=e.handleNoFieldsInSchema(d)),a.log("=====normalized json data======","info"),a.log(a.JSON.stringify(d,null,"    "),"info"),d},handleJsonReqest:function(b,c){var d,e,f,g=this.get("_externalDS"),h=b.typedData||"",i=g.params,j=g.url,k=i.query,l=this;this._DS.callBack={success:function(a){var b=a.response,e=i.schema;return d=l.getNormalizedData(b,e,h),c(d)},failure:function(b){return a.log(b,"debug"),c(null)}},e=i.request+"&"+k+"="+h,f=j+e,a.log("=====request Url======","info"),a.log(f,"info"),this._DS.sendRequest({request:e,callback:this._DS.callBack})},createGossipParams:function(b){function c(){var a,b,c={},d=null,e=null,f=m.get("geo");return f&&(a=f.lat,b=f.lon,e=f.woeid,null!==a&&null!==b&&(d=b+","+a,c.latlon=d),null!==e&&(c.geoid=e)),c}var d,e,f,m=this,n=this.get("webHistory"),o=this.get("smw"),p=this.get("ultEnabled"),q=this.get("maxSuggests"),r=this.get("pubid"),s={},t=this._originalQuery||"";return 0!==r&&(s.pubid=r),f=this.getCursorPosOnSearchBox(),a.Lang.isNumber(f)&&f<b.length&&(s.ipos=f),n&&n.crumb&&n.maxSuggestions>0&&(s.f=1,s[".crumb"]=n.crumb),o&&o.crumb&&o.maxSuggestions>0&&(s[".crumb"]=o.crumb),e=c(),e.latlon&&(s.ll=e.latlon),(e.geoid||0===e.geoid)&&(s.geoid=e.geoid),s.output="sd1",s.command=encodeURIComponent(b),s.pq=encodeURIComponent(t),s.l=1,s.bm=3,s.appid=this.get("appId"),s[h]=(new Date).getTime(),s.nresults=q,s[g]=this.get("sendBCookie")?this.get("bcookie"):null,p&&(d=this.get("ult"),s[i]=encodeURIComponent(d[i]),s[j]=encodeURIComponent(d[j]),s[k]=encodeURIComponent(d[k]),s[l]=d[l]),a.mix(s,this.get("gossipParams"),!0),a.log(s,"debug"),s},handleDefaultDS:function(c,d){function e(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+a[b]);return c.join("&")}function f(c){return a.log("jsonPSuccess for query:"+i,"debug",b),a.log(c,"debug"),l&&j.myCache.add(i,c),d(c)}function g(b){return a.log(b,"debug"),d(null)}var h,i=c.typedData||"",j=this,k=this.createGossipParams(i),l=this.get("allowCache");h=this.get("baseUrl"),c.ylcForAutoComplete&&(h+=c.ylcForAutoComplete),h+="?"+e(k)+"&callback={callback}",a.log(h,"debug"),a.jsonp(h,{on:{success:f,failure:g}})},fireJsonData:function(c){var d,e=this,g=this.get("allowCache"),h=this.myCache;this.now&&this.now.cancel(),this.now=a.later(f,this,function(){return g&&h&&h.retrieve(c.typedData)&&(d=h.retrieve(c.typedData),d&&d.response)?(a.log("cached response","debug",b),e._totalHitsToCache+=1,void e.fire(m,{jsonData:d.response})):void this.getJsonData(c,function(c){e._totalHitsToSuggestServer+=1,c?(a.log("un-cached response","debug",b),a.log("suggest data received, firing response-received event:"+m,"debug",b),e.fire(m,{jsonData:c})):(a.log("no suggest data received, firing no-response-received event:"+n,"debug",b),e.fire(n))})})},getJsonData:function(a,b){var c=this,d=this.get("_externalDS"),e=a.typedData||"";return""!==e||c.isTrendingEnabled()?d?this.handleExternalDS(a,b):this.handleDefaultDS(a,b):b(null)}})},"0.0.1",{requires:["search-assist"]}),YUI.add("search-assist-history-suggestions-plugin",function(a){"use strict";var b,c="sa-history",d="sa-history-clear",e="mb-ac-clear-btn-wrapper",f="HISTORY_CLEAR_TITLE",g="/history",h=3,i="suggest-markup-has-been-attached-to-DOM";b=function(){b.superclass.constructor.apply(this,arguments)},a.mix(b,{NAME:"search-assist-history-suggestions-plugin",NS:"HistorySuggestions",ATTRS:{}}),a.extend(b,a.Plugin.Base,{initializer:function(){a.log("instantiating the history Search plugin #######################","debug"),this.doAfter(i,this._highlightHistorySuggestions)},_highlightHistorySuggestions:function(b){var i,j,k,l,m,n=this.get("host"),o=n.get("webHistory"),p=n.get("tray"),q=p.Node,r=0;j=o.bcrumb,k=o.maxSuggestions||h,0===o.maxSuggestions&&(k=0),b&&b.jsonData&&(i=b.jsonData,i.r&&(l=i.r)),q&&(m=q.all("> ul li"),a.each(l,function(b,h){if(13===b.m){r+=1;var i,l,o,p,q,s,t=m.item(h),u=t.getAttribute("data"),v=n.get("translation")[f]||"Clear";if(k>=r){if(t.addClass(c),!j)return;q=function(b){a.log("Error on removing history "+b,"debug")},s=function(b){a.log("History removed successfully "+b,"debug"),t.remove(!0)},l=g+"?action=del&query="+u+"&_bcrumb="+j+"&sa=1&o=js",o={method:"GET",on:{success:s,failure:q}},p=function(b){b.stopPropagation();var c;c&&c.isInProgress()||(c=a.io(l,o))},i=a.Node.create('<span class="'+d+'">'+v+"</span>"),i.on("click",p),!n.get("mobileAutoComplete")||"phone"!==n.get("currentDevice")&&"tablet"!==n.get("currentDevice")?t.append(i):(t.one(".ac-content").insert('<td width="45" class="'+e+'"></td>',"after"),t.one("."+e).append(i))}}}))}}),a.HistorySuggestionsPlugin=b},"1.0.0",{requires:["plugin","base-pluginhost","io-base"]}),YUI.add("search-assist-linktrack",function(a,b){"use strict";var c="linktrack",d="event-search-form-instrumented",e="searchForm";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"LINKTRACK",ATTRS:{}}),a.SEARCHASSIST.LINKTRACK=a.extend(c,a.SEARCHASSIST,{initializer:function(){this.ULT=a.namespace("SA").ULT,this.ULT&&(this._gprid="",a.log("Instantiating ULT for link tracking","debug",b))},_getGprid:function(){return this._gprid||""},_setGprid:function(a){return this._gprid=a||"",this._gprid},_generateLocalTimestamp:function(){var a=new Date;return Math.round(a.getTime()/1e3)},createi13nObj:function(b){return a.config.i13n?a.mix(a.config.i13n,{spaceid:b}):a.config.i13n={spaceid:b},a.config.i13n},getUltObj:function(c,d){var e,f,g,h=this,i=this._generateLocalTimestamp(),j={};return d=d||{},g=h.get("ult"),e=g.vtestid||d.vtestid||null,f=g.mtestid||d.mtestid||null,d&&a.mix(j,d),j.t_stmp=i,j.query=c.query,j.qstrl=c.qstrl,j.pqstr=c.pqstr,j.pqstrl=c.pqstrl,j.pos=c.pos,j.n_sugg=c.n_sugg,j.gprid=this._getGprid(),j.origin=a.config.win.location.hostname,j.vtestid=encodeURIComponent(e),j.mtestid=encodeURIComponent(f),c.sec&&(j.sec=c.sec),c.slk&&(j.slk=c.slk),c.uqstr&&(j.uqstr=c.uqstr),c.uqstrl&&(j.uqstrl=c.uqstrl),this.get("sendBCookie")&&(j.bck=this.get("bcookie")),null===e&&a.log("vtestid not specified","warn",b),null===f&&a.log("mtestid not specified","warn",b),j},instrumentFormSubmit:function(a){var b,c,e,f,g={},h={};this.ULT&&(b=this.get("ultEnabled"),c=this.get("ult"),e=c.spaceId,b&&e&&(f=this.get("extraUltParams")||{},h=this.getUltObj(a,f),g=this.setYlcOnAction(h,e),this.setHiddenFormItems(a,f)),this.fire(d,g))},setHiddenFormItems:function(b,c){var d,e,f,g,h=this.get("searchForm"),i=this.get("ult");d=b.fr2,e=i.csrcpvid||c.csrcpvid,f=this._getGprid(),g=this,a.each({fr2:d,pvid:e,gprid:f},function(b,c){if("fr2"===c)b||(b="sb-top"),b+="-"+g.get("appId");else if(!b)return;var d=h.get(c);d||(d=a.Node.create('<input type="hidden" name="'+c+'">'),h.prepend(d)),d.set("value",b)})},setYlcOnAction:function(b,c){var f,g=this.get(e),h=g.getAttribute("action");return this.ULT.instrument?(a.log(b,"debug"),f=this.getInstrumentedUrl(h,b),g.setAttribute("action",f),a.log("Firing:"+d,"debug"),{spaceId:c,ultParams:b,instrumentedSubmitUrl:f}):void 0},getInstrumentedUrl:function(a,b){var c=this,d=c.get("ult").spaceId;return d?(this.createi13nObj(d),this.ULT.instrument?this.ULT.instrument(a,b):null):null},sendBeacon:function(a,b){if(b){var c=document.createElement("img");c.src=this.ULT.instrument(b,a)}else this.ULT.beacon(a)},logAutoCompletion:function(a,b,c){var d,e=this,f=this.get("ult"),g=f.spaceId,h={actn:"clk",qstrl:b.length,query:b,pos:c,pqstr:a,pqstrl:a.length,uqstr:b.substr(a.length),uqstrl:b.substr(a.length).length,gprid:e._gprid,n_sugg:e.get("tray").len,sec:"search",slk:"qryupdate",_S:g};d=this.ULT.DEFAULT_BEACON_URL,this.sendBeacon(h,d)}})},"0.0.1",{requires:["search-assist","search-assist-ult"]}),YUI.add("search-assist-mobile",function(a,b){"use strict";var c="mobile",d="searchBox",e="searchBoxContainer",f="searchForm",g="saContainer",h="MOBILE_EXIT_BUTTON_TITLE",i="MOBILE_PLACEHOLDER_TITLE",j="MOBILE_SEARCH_FOR_TITLE",k="mbxWrapperNode",l="bringtofront",m="widen-sa-tray",n="widen-search-box",o="mask-tray",p="mobile-expand-sbx-wrapper-style",q="search-box-placeholder-for-cancel",r="mobile-expand-cancel-btn",s="mbx-sa-tray-wrapper-style",t="mb-ac-wrapper",u="mb_ac",v="ac-btn",w="ac-content",x="sa-ac-table",y="sa-clear-btn",z="sa-clear-btn-with-cancel-btn",A=500,B=100,C="query-emptiness",D="valuechange";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"Sa-Mobile",ATTRS:{}}),a.SEARCHASSIST.MOBILE=a.extend(c,a.SEARCHASSIST,{mobileInit:function(){this.publishMobileEvts()},initializer:function(c){a.log("instantiating Mobile related","debug",b),this.get("quietMode")||this.mobileInit(c)},publishMobileEvts:function(){var c=this,h=this,i=this,j=this,k=h.get(f),m=h.get(d),n=this.get(g),o=h.get("mobileExpandMode"),p=h.get("currentDevice"),q=this._allSubscr;this._touchmoved=!1,a.log("publishing Mobile events","debug",b),m&&("phone"===p||"tablet"===p)&&(this._mkeyUp=!1,this._mkeyDown=!1,m.getDOMNode(!0).addEventListener("input",function(){c._mkeyUp||c._mkeyDown?(c._mkeyUp=!1,c._mkeyDown=!1):c.fireInTheHole()},!0),q._mobileNativeUp=m.on("keyup",function(){c._mkeyUp=!0}),q._mobileNativeDown=m.on("keydown",function(){c._mkeyDown=!0}),this.pullSbxToTopOnFocus(),this.get("mobileAutoComplete")&&n.addClass(t),q._clientSrchNodeOntouchEnd=m.on("click",function(a){h.get("mobileExpandMode")&&(a.stopPropagation(),a.preventDefault()),j.handleEventOnSearchBox(a,"touchend")}),o||(a.delegate(["touchstart","click"],function(){c._clickOnSuggItem=!0},h.get(g),"li"),a.delegate("touchend",function(){c._clickOnSuggItem=!1},h.get(g),"li"),q._blurOnMobileNoExpand=m.on("blur",function(){return c._clickOnSuggItem?void(c._clickOnSuggItem=!1):i._noRefresh===!0?void(i._noRefresh=!1):void i.removeSuggestionsMarkup()
}))),k&&o&&("phone"===p||"tablet"===p)&&(q._traySrchBoxOnFocus=h.get(d).on("click",function(){h.get(e).hasClass(l)||h.get(e).addClass(l)})),("phone"===p||"tablet"===p)&&(a.Event.defineOutside("touchend"),q._traySrchFormOntouchEndOutside=h.get(f).on("touchendoutside",function(){o&&j.removeMobileExpand(),c.removeSuggestionsMarkup()})),("phone"===p||"tablet"===p)&&(a.delegate("touchend",function(a){h.get(d).focus(),c.removeHighlightClasses(a)},h.get(g),"li"),a.delegate("mouseover",function(){h.get(d).focus()},h.get(g),"li"),a.delegate("click",function(a){c.removeHighlightClasses(a)},h.get(g),"li"),a.delegate(["click","touchend"],function(){h.get(d).focus()},h.get(e),"*"),this._touchmoved=!1,a.delegate(["touchend","touchmove","click"],function(a){c.handleMobileEventsOnListItems(a)},h.get(g),"li"))},handleMobileEventsOnListItems:function(a){var b=this,c=this;return"touchmove"===a.type?void(this._touchmoved=!0):this._touchmoved===!0?void(this._touchmoved=!1):!b.get("mobileAutoComplete")||a.target.get("className")!==u&&a.target.get("className")!==v?(b.handleEventOnSuggestItem(a),b.onFormSubmission(a),void b.removeHighlightClasses(a)):(a.stopPropagation(),a.preventDefault(),b.handleEventOnSuggestItem(a,"autoComplete"),void c.get(d).focus())},addAutoCompleteBtn:function(a){var b=a.getHTML(),c='<span class="'+u+'"></span>',d='<table class="'+x+'" width="100%" cellspacing="0" cellpadding="0" border="0"><tr> <td class="'+w+'">'+b+'</td><td width="45" class="'+v+'">'+c+"</td></tr></table>";a.setHTML(d)},handleMobileEventsOnSearchBox:function(c,e){var f,g=this,h=this,i=this.getQuery(),j=this,k=this,l=j.get("mobileExpandMode"),m=j.isTrendingEnabled();if(l&&!this.closeOnDone&&(this.closeOnDone=!0,a.later(A,this,function(){k.closeOnDone=k.get(d).once("blur",function(b){l?a.later(B,k,function(){k.removeMobileExpand(b)}):a.later(B,k,function(){k.removeSuggestionsMarkup()})})})),l&&this.addMobileExpand(),"touchend"===e&&(f=j.get(d).get("value"),j.get(d).set("value",f).focus()),"touchend"===e){if(h.isTrayOpen())return;""===i?j.isTrendingEnabled()&&g.fireInTheHole(c):g.fireInTheHole(c)}return"keyup"===e?void(""===i?m&&g.fireInTheHole(c):g.fireInTheHole(c)):e===D||e===C?(a.log("mobile:event:"+e,"debug",b),void(m?""===this.getQuery()&&(a.log("query is empty","debug",b),h.isTrayOpen()&&h.isTrayTypeTrending()?a.log("trending tray already open","debug"):(a.log("Empty query and no tray is open so triggering tray to open","debug",b),g.fireInTheHole(c))):!h.isTrayOpen()||i&&""!==i||h.removeSuggestionsMarkup())):void 0},widenTray:function(){function a(){h.Node.addClass(m)}function b(){c.get(d).focus(),h&&h.Node&&f.isModeExpanded()?a():g&&f.removeMobileExpand()}var c=this,e=this,f=this,g=c.isTrendingEnabled(),h=e.getTray();b()},updateSuggOnNoSugg:function(c,d){var e,f,g=this,h=g.getTray();return a.log("no suggestions available for the query autocompleted, so adding the same query as suggestionf or mobile","debug",b),f=g.highlightSuggestion(c,c),e=a.Node.create("<li>"+this.get("translation")[j]+' "'+f+'"</li>'),e.setAttribute("pos",0),e.setAttribute("data",c),d.append(e),h.len=1,d},addMobileExpand:function(){var b,c,e=this,f=(e.get("currentDevice"),e.get(d));a.log("adding mobile expansion","debug"),e.get(k).addClass(p),f.addClass(n),e.get("disablePlaceHolder")||(b=this.get("translation")[i],f.setAttribute("placeholder",b+" "+e.get("property"))),this.renderClearButton(),e.get("cancelButton")&&this.renderCancelBtn(),this.renderMaskTray(),c=e.get("saContainer"),c&&c.addClass(s)},removeMobileExpand:function(){var c,e=this,f=e.getTray(),g=a.one("."+y),h=this,i=h.get(d),j=a.one("."+o),l=h.get(k),t=h.get("saContainer");t&&(a.log("removing class mbx-sa-tray-wrapper-style","debug"),t.removeClass(s)),l&&l.removeClass(p),a.log("removing mobile Expand","debug",b),h.get("cancelButton")&&(c=a.one("."+r),c&&(h.get(d).removeClass(q),c.hide()),g=a.one("."+z)),this._detachCloseOnDone(),j&&j.hide(),i&&i.removeClass(n),g&&g.hide(),f&&f.Node&&f.Node.removeClass(m),e.removeSuggestionsMarkup(),h.get("disablePlaceHolder")||i.removeAttribute("placeholder")},renderMaskTray:function(){var b=a.one("."+o),c=this,d=this;b?b.show():(b=a.Node.create("<div></div>"),c.get(f).append(b),b.addClass(o),b.on(["touchstart","click"],function(a){a.stopPropagation(),a.preventDefault(),d.removeMobileExpand()}))},isModeExpanded:function(){return a.one("."+n)?!0:!1},renderCancelBtn:function(){var b,c=a.one("."+r),e=this,f=this,g=function(b){a.log("removing mobile expansion ##########################","debug"),b.stopPropagation(),b.preventDefault(),f.removeMobileExpand()};if(c)e.get(d).addClass(q),c.show();else{try{b=this.get("translation")[h],c=a.Node.create('<div class="'+r+'">'+b+"</div>")}catch(i){}c&&(e.get(k).append(c),e.get(d).addClass(q),c.on(["touchstart","touchend","click"],g))}},renderClearButton:function(){var b=this,c=a.one("."+y),e=b.get(d),f=this;b.get("cancelButton")&&(c=a.one("."+z)),c?f.isTrayTrending()&&!f.getQuery()?c.hide():f.getQuery()?c.show():c.hide():(c=a.Node.create("<div></div>"),c.setHTML('<div class="crosshair-wrapper"><div id="clearSearchBox" class="crosshair-head" role="button" aria-label="clear search box"><div class="hair"></div><div class="hair"></div></div></div'),c.addClass(b.get("cancelButton")?z:y),b.get(k).append(c),c.on(["touchstart","click"],function(a){a.stopPropagation(),e.set("value",""),this.hide()}),c.on("touchend",function(a){a.stopPropagation()}),""===f.getQuery()&&c.hide())},_detachCloseOnDone:function(){var c=this.get(d);this.closeOnDone&&a.Lang.isFunction(this.closeOnDone.detach)&&(this.closeOnDone.detach(),delete this.closeOnDone,this.closeOnDone=null,c.blur(),a.log("REMOVED close on done registeration","debug",b))},pullSbxToTopOnFocus:function(){var b=function(){window.pageYOffset<=0&&window.scrollTo(0,1)};this.get(d).on("focus",function(){a.later(0,null,function(){b()})})}})},"0.0.1",{requires:["search-assist","search-assist-core","search-assist-linktrack","search-assist-navigate","intl"]}),YUI.add("search-assist-navigate",function(a,b){"use strict";var c="navigate",d="searchBox",e=1,f="sa-tray-list-container",g="list-item-selected",h="list-item-hover",i="search-assist-suggestion-selected",j=3e4,k="some-activity-in-the-searchbox",l="query-emptiness",m=8,n=9,o=27,p=39,q=37,r=38,s=40,t=13,u=16,v=18;c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"Sa-Navigate",ATTRS:{}}),a.SEARCHASSIST.NAVIGATE=a.extend(c,a.SEARCHASSIST,{navInit:function(){this.publishKeyboardEvts(),this._tabCount=e,this._origQuery=this.getQuery(),this.timeSinceLastKey=0},initializer:function(c){a.log("instantiating NAVIGATE","debug",b),this._originalQuery=this.getQuery(),this.get("quietMode")||this.navInit(c)},getOrigQuery:function(){return this._origQuery},setOrigQuery:function(a){this._origQuery=a},minKeySatisfied:function(a){return a&&a.length>=this.get("minKey")?!0:!1},fireInTheHole:function(b,c){var d,e=this,f=e.getQuery(),g=this,h=this,i={},j=null,l=this;return d=this.getOrigQuery(),c&&this.get("logAutoComplete")&&l.get("ultEnabled")&&!l.get("_externalDS")&&this.ULT&&(j=this.getYlcforAutoCompleteLogging(c)),this.get("minKey")>0&&!this.minKeySatisfied(f)?void g.removeSuggestionsMarkup():(g.setRenderedTrayType(""===f&&l.isTrendingEnabled()?"trending":"normal"),this.setOrigQuery(f),a.log("firing "+k+' event: fired-typedData:"'+f+'"',"debug"),i={typedData:f,evtFacade:b},j&&(i.ylcForAutoComplete=j),void h.fire(k,i))},getYlcforAutoCompleteLogging:function(c){var d,e={},f=this,g=this,h=this,i=f.get("tray"),j={},k=g.get("extraUltParams")||{};return("tab"===c.actn||"arrow"===c.actn)&&(e.actn="keybrd"),"mb_ac"===c.actn&&(e.actn="mobile"),e.pos=c.pos,e.slk="qryupdate",e.sec="search",e.query=c.value,e.qstrl=e.query.length,e.pqstr=c.query,e.pqstrl=e.pqstr.length,e.uqstr=e.query.substr(e.pqstrl),e.uqstrl=e.uqstr.length,i&&i.len&&(e.n_sugg=i.len),e.fr2="sa-gp",j=h.getUltObj(e,k),a.log("logging autocomplete","debug",b),d=this.getInstrumentedUrl("",j)},_defEvtFireInTheHole:function(c){var d=this,f=this,g={},h=this;a.log("received "+k+" event","debug",b),c&&(c.evtFacade&&(this.evtFacade=c.evtFacade),a.log('received typedData:"'+c.typedData+'"',"debug",b),c.evtFacade?(a.log("received flame.evtFacade","debug",b),c.evtFacade.charCode!==n&&(this._tabCount=e)):a.log("missed passing eventFacade in firedinthehole event","debug",b),g.ylcForAutoComplete=c.ylcForAutoComplete||null,g.typedData=c.typedData,g.typedData?d.fireJsonData(g):h.isTrendingEnabled()===!0?(a.log("showing trending search","debug",b),d.fireJsonData(g)):(f.removeSuggestionsMarkup(),a.log("trending search supressed","debug",b)))},okTofollowTabIndex:function(){return a.log("_tabCount:"+this._tabCount,"debug",b),this._tabCount===e?(this.update_tabCount(),this.isTrayOpen(),!1):(this.update_tabCount(),!0)},update_tabCount:function(){this._tabCount=(this._tabCount+1)%2},getAutoCompleteValue:function(){var b,c=a.one("."+f+" li");return c?b=decodeURIComponent(c.getAttribute("data")):null},okToAutoComplete:function(){var a=this.isAnySuggestionSelected();return a?!1:!0},handleTab:function(b){var c,e,f=this,g=this,h=g.get(d),i=g.getQuery(),j=f.getTray();if(g.isTrendingEnabled()||i){if(!i)return void f.removeSuggestionsMarkup();if(this.okTofollowTabIndex())return void f.removeSuggestionsMarkup();if(b.preventDefault(),h&&j&&j.Node){if(!this.okToAutoComplete())return void this.fireInTheHole(b);c=this.getAutoCompleteValue(),c?(g.setSearchBoxVal(c),e={pos:1,value:c,query:i,actn:"tab"},this.fireInTheHole(b,e)):(a.log("tray exists but did not get any autocomplete suggestions","warn"),f.closeTray())}else this.fireInTheHole(b),this.resetTabTrack()}},getCursorPos:function(b){var c,d,e=0;return b?b.selectionStart?b.selectionStart:a.config.doc.selection&&a.config.doc.selection.createRange()?(c=a.config.doc,c.activeElement.focus(),d=c.selection.createRange(),d.moveStart("character",-c.activeElement.value.length),e=d.text.length):0:null},getCursorPosOnSearchBox:function(){var c=this,e=c.get(d),f=e.getDOMNode(),g=this.getCursorPos(f);return null===g?(a.log("unable to get cursor position","warn",b),null):(a.log("caretPos:"+g,"debug"),g)},isCursorAttheEnd:function(){var c=this,d=c.getQuery(),e=d.length,f=this.getCursorPosOnSearchBox();return a.log("len:"+e,"debug",b),a.log("cursorPos:"+f,"debug",b),e===f?!0:!1},handleArrowRight:function(b){var c,e,f=this,g=this,h=g.get(d),i=g.getQuery(),j=f.getTray();if(h&&j&&j.Node)if(this.okToAutoComplete()&&this.isCursorAttheEnd())c=this.getAutoCompleteValue(),c&&i!==c?(f._noRefresh=!0,h.blur().set("value",c).focus(),e={pos:1,value:c,query:i,actn:"arrow"},this.fireInTheHole(b,e)):a.log("tray exists but did not get any autocomplete suggestions","warn");else if(this.isCursorAttheEnd())return void this.fireInTheHole(b)},handleEsc:function(){var b=this,c=this;a.log("closing tray on esc press","debug"),b.removeSuggestionsMarkup(),c.get(d).blur()},resetTabTrack:function(){this._tabCount=e},isAnySuggestionSelected:function(){var c=a.one("."+f+" ."+g);return a.log("selected suggestion node:"+c,"debug",b),c},handleArrowUp:function(c){var e,i,j,k,l,m,n,o,p=this,q=(p.get(d),0),r=[];if(a.log("ARROW UP KEY ***************","debug",b),this.resetTabTrack(),p._native)return void p.fireInTheHole();if(j=a.one("."+f),!j)return void this.fireInTheHole(c);if(k=j.all("> li"))if(k.each(function(a,b){r[b]=a}),i=r.length,l=this.isAnySuggestionSelected()||a.one("."+f+" ."+h)){for(a.log("selectedSuggestion:"+l.get("text"),"debug"),q=0,m=this.getOrigQuery(),q=0;i>q;q+=1)if(r[q].hasClass(g)||r[q].hasClass(h)){if(r[q].removeClass(g),r[q].removeClass(h),0===q){p.handleNativeInputMethod(m);break}n=(q-1)%i,e=r[n].getAttribute("data"),o=r[n].getAttribute("pos"),p.handleNativeInputMethod(e,r[n]),this.fireCurrentSuggestionSelected({suggestion:e,pos:o});break}}else a.log("no suggestion selected :(","debug",b),n=i-1,r[n]&&(e=r[n].getAttribute("data"),o=r[n].getAttribute("pos"),this.fireCurrentSuggestionSelected({suggestion:e,pos:o}),p.handleNativeInputMethod(e,r[n]))},fireCurrentSuggestionSelected:function(a){this.fire(i,a)},handleArrowDown:function(c){var e,i,j,k,l,m,n,o,p=this,q=this,r=(q.get(d),0),s=[];if(a.log("ARROW DOWN KEY ***************","debug",b),this.resetTabTrack(),q._native)return void q.fireInTheHole();if(j=a.one("."+f),!j)return void p.fireInTheHole(c);if(k=j.all("> li"))if(k.each(function(a,b){s[b]=a}),i=s.length,l=this.isAnySuggestionSelected()||a.one("."+f+" ."+h)){for(r=0,m=this.getOrigQuery(),r=0;i>r;r+=1)if(s[r].hasClass(g)||s[r].hasClass(h)){if(s[r].removeClass(g),s[r].removeClass(h),r===i-1){q.handleNativeInputMethod(m);break}n=(r+1)%i,e=s[n].getAttribute("data"),o=s[n].getAttribute("pos"),this.fireCurrentSuggestionSelected({suggestion:e,pos:o}),q.handleNativeInputMethod(e,s[n]);break}}else a.log("no suggestion selected :( ","debug",b),s[0]&&(e=s[0].getAttribute("data"),o=s[0].getAttribute("pos"),this.fireCurrentSuggestionSelected({suggestion:e,pos:o}),q.handleNativeInputMethod(e,s[0]))},handleNativeInputMethod:function(b,c){var e=this.get(d),f=e.get("value"),h=this,i=this;return""===f||i.get("allIe")||i.get("gecko")||i._c===i._d&&i._c===f||void 0===i._c||!i._native?(h._noRefresh=!0,e.blur().set("value",decodeURIComponent(b)).focus(),void(c&&c.addClass(g))):(a.log("native tray detected, updating tray","debug"),void i.fireInTheHole())},handleAnyKeySearch:function(b){var c,e,f,g,h,i=a.config.win,j=a.config.doc,k=this,l=this,n=function(a){if(f=a.keyCode,h=a.target||a.srcElement,g||(g=k.get(d).getDOMNode()),"EMBED"!==h.tagName&&"OBJECT"!==h.tagName&&"INPUT"!==h.tagName&&"TEXTAREA"!==h.tagName&&!a.altKey&&!a.metaKey&&!a.ctrlKey&&(32>f||f>40)&&9!==f&&13!==f&&16!==f&&f!==o){if(l.get("backspaceBehaviorNative")&&f===m)return;c=g.value.length,c&&(f===m?(a.preventDefault(),g.value=g.value.substr(0,g.value.length-1)):b&&(g.value=g.value+" ",c+=1),l.get("replaceQueryOnFocus")&&(g.value=""),g.setSelectionRange?g.setSelectionRange(c,c):g.createTextRange&&(e=g.createTextRange(),e.moveStart("character",c),e.select())),g.focus()}};i.addEventListener?(i.removeEventListener("keydown",this._fnCheckFocusPtr),this._fnCheckFocusPtr=n,i.addEventListener("keydown",n,!1),a.log("################### w.addEventListener","debug")):i.attachEvent&&(this.ieAnyKeyDocumentEvt&&j.detachEvent("onkeydown",this._fnCheckFocusPtr),this._fnCheckFocusPtr=n,this.ieAnyKeyDocumentEvt=j.attachEvent("onkeydown",n),a.log("################### d.attachEvent","debug"))},getKeyDownState:function(){return this.keyDown},stopMonitoringUserIdleNess:function(){var a=this._allSubscr;a._timeSinceLastkeyStroke&&a._timeSinceLastkeyStroke.cancel()},monitorUserIdleNess:function(){var b=this._allSubscr,c=this;this.noActivityForLong=!1,b._timeSinceLastkeyStroke&&(b._timeSinceLastkeyStroke.cancel(),this.timeSinceLastKey=0),b._timeSinceLastkeyStroke=a.later(2e3,this,function(){c.timeSinceLastKey=c.timeSinceLastKey+2e3,c.timeSinceLastKey>j&&(c.noActivityForLong=!0,b._timeSinceLastkeyStroke.cancel())},[],!0)},publishKeyboardEvts:function(){a.log("publishing default handler function for the event when there is some activity in search box","debug",b),this.publish(k,{defaultFn:a.bind("_defEvtFireInTheHole",this)});var c=this,e=c.get(d),f=this,g=this,h=this._allSubscr,i=this.get("noSpaceOnFocus");this.keyDown=!1,h._navigateHtmlOnKeyDown=a.one("html").on("keydown",function(a){a.charCode!==m&&(f.keyDown=!0)}),h._navigateHtmlOnKeyUp=a.one("html").on("keyup",function(){f.keyDown=!1}),c.get("anyKeySearch")===!0&&f.handleAnyKeySearch(i?!1:!0),e?(h._navigateSrchNodeOnKeyDown=e.on("keydown",function(b){a.log("escape on keydown","debug"),b.charCode===o&&f.handleEsc(b),b.charCode===n&&f.handleTab(b),b.charCode===r&&b.preventDefault()}),a.later(200,this,function(){h._navigateSrchNodeOnFocus=e.on("focus",function(){""===f.getQuery()&&this.fire(l)})}),h._navigateSrchNodeOnEmptyQuery=e.on(l,function(a){g.handleEventOnSearchBox(a,l)}),h._navigateSrchNodeOnKeyUp=e.on("keyup",function(a){f.handleKeyEvent(a,"keyup")})):a.log("invalid searchNode, no keyboard or mouse or touch events registered","error",b)},handleKeyEvent:function(c,d){var e=this,f=this,g=this;this.timeSinceLastKey=0,c.charCode===s?e.handleArrowDown(c):c.charCode===r?e.handleArrowUp(c):c.charCode===p?e.handleArrowRight(c):c.charCode===q?a.log("arrow left shouldnt do anything","info"):c.charCode===o?a.log("Esc key on keyup","debug"):c.charCode===m?""!==e.getQuery()?(a.log("backspace was pressed, query is empty - firing suggest","debug",b),e.fireInTheHole(c)):f.isTrayTrending()&&!f.isTrayOpen()&&(a.log("backspace was pressed, tray not open, query is valid - firing suggest","debug",b),e.fireInTheHole(c)):c.charCode===t?(e._native===!0&&(e._native=!1,g.handleEventOnSearchBox(c,d)),a.log("return key","debug")):c.charCode===v||c.charCode===u?a.log("special key pressed","debug",b):(a.log("searchnode on keyup","debug",b),g.handleEventOnSearchBox(c,d))}})},"0.0.1",{requires:["search-assist"]}),YUI.add("search-assist-smw-suggestions-plugin",function(a){"use strict";var b,c="sa-smw",d="sa-smw-private-label",e=3,f="SMW_PRIVATE_LABEL_TITLE",g="mb-ac-clear-btn-wrapper",h="suggest-markup-has-been-attached-to-DOM";b=function(){b.superclass.constructor.apply(this,arguments)},a.mix(b,{NAME:"search-assist-history-suggestions-plugin",NS:"SmwSuggestions",ATTRS:{}}),a.extend(b,a.Plugin.Base,{initializer:function(){a.log("instantiating the SMW plugin #######################","debug"),this.doAfter(h,this._highlightSmwSuggestions)},_highlightSmwSuggestions:function(b){var h,i,j,k,l,m=this.get("host"),n=m.get("tray"),o=n.Node,p=m.get("smw"),q=m.get("translation")[f]||"Private result",r=0;b&&b.jsonData&&(h=b.jsonData,h.r&&(j=h.r)),k=p.maxSuggestions||e,0===p.maxSuggestions&&(k=0),o&&(l=o.all("> ul li"),a.each(j,function(b,e){if(31===b.m){r+=1;var f=l.item(e);k>=r&&(f.setAttribute("type","smw"),f.addClass(c),i=a.Node.create('<span class="'+d+'">'+q+"</span>"),!m.get("mobileAutoComplete")||"phone"!==m.get("currentDevice")&&"tablet"!==m.get("currentDevice")?f.append(i):(f.one(".ac-content").insert('<td width="80" class="'+g+'"></td>',"after"),f.one("."+g).append(i)))}}))}}),a.namespace("SEARCHASSIST").SmwSuggestionsPlugin=b},"1.0.0",{requires:["plugin","base-pluginhost","io-base"]}),YUI.add("search-assist-tray",function(a,b){"use strict";var c="tray",d="searchBox",e="searchBoxContainer",f="searchForm",g="saFormWrapper",h="saContainer",i=5,j=500,k="TRENDING_NOW_TITLE",l="RELATED_TITLE",m="m",n=13,o="m",p=4,q="m",r=2,s="trending",t="normal",u="sa-tray",v="sa-tray-list-container",w="trending-title",x="related-title",y="list-item-selected",z="list-item-hover",A="trans-hide",B="spcl-sugg",C="trending-label-position",D="related-label-position",E="sub-assist",F="absolute",G="no-wrap",H="truncation",I="measurer-absolute",J="measurer-no-wrap",K="measurer-no-overflow",L="branding",M="response-received",N="search-assist-tray-showing",O="no-response-received",P="suggest-markup-has-been-attached-to-DOM",Q="zero-suggestions-rendered-to-DOM",R="before-suggest-markup-has-been-attached-to-DOM",S="search-assist-tray-removed",T="search-assist-suggestion-selected",U="search-assist-tray-click-outside",V="search-assist-form-submit",W="tray";c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"Sa-Tray",ATTRS:{tray:{},cloud:{}}}),a.SEARCHASSIST.TRAY=a.extend(c,a.SEARCHASSIST,{trayInit:function(){this.publishTrayEvts(),this.set("tray",{}),this._curSuggestion="",this._curPos="",this._firstSuggestion=""},initializer:function(c){a.log("instantiating TRAY","debug",b),this.get("quietMode")||this.trayInit(c),this.get("configPanel")&&this.plug(a.SEARCHASSIST.SaConfigUIPlugin),this.get("ariaPlug")&&this.plug(a.SEARCHASSIST.AriaPlugin),this._sbxPadLeftInt=this.getSearchBoxPadding("left")||0,this._sbxPadRightInt=this.getSearchBoxPadding("right")||0,this._queryWidth=0,this._offsetWidth=0,this._isWidthComputed=0,this._subAssistReady=!1},publishTrayEvts:function(){var c=this,d=this,e=d.get(f),i=d.get("currentDevice"),j=this._allSubscr;a.log("publishing Tray events","debug",b),this.publish(M,{defaultFn:a.bind("_defEvtRespRecvdFn",this)}),this.publish(P,{defaultFn:a.bind("_defEvtSuggestMarkupRendered",this)}),this.publish(O,{defaultFn:a.bind("_defEvtNoRespRecvdFn",this)}),d.get("autoAlign")&&this.alignTrayRegisteration(),j._traySuggestionSelect=d.on(T,function(a){c._curSuggestion=a.suggestion,c._curPos=parseInt(a.pos,10)}),e&&(j._traySrchFormOnSubmit=e.on("submit",function(a){c.onFormSubmission(a)}),j._traySrchFormWrapperOnClickOutside=d.get(g).on("clickoutside",function(){a.log("clickoutside captured on ","debug",b),c.removeSuggestionsMarkup(),c.fire(U)})),"desktop"===i&&(a.delegate("mouseover",function(){c.removeAllListHighlights(),this.addClass(z)},d.get(h),"li"),a.delegate("mouseout",function(a){c.removeHighlightClasses(a)},d.get(h),"li"),a.delegate(["click"],function(a){c.handleEventOnSuggestItem(a),c.onFormSubmission(a),c.removeHighlightClasses(a)},d.get(h),"li"))},getTray:function(){return this.get("tray")},isTrayEmpty:function(){var b=a.one("."+v+" li");return b?(a.log("trays first list element:"+b,"debug"),!1):!0},getSuggestData:function(a){var b;return b=decodeURIComponent(a.currentTarget.getAttribute("data"))},getSuggestPosition:function(a){var b;return b="B"===a.target.get("nodeName").toUpperCase()?a.target.get("parentNode").getAttribute("pos"):a.currentTarget.getAttribute("pos"),b=parseInt(b,10)},removeAllListHighlights:function(){a.all("."+v+" ."+z).removeClass(z),a.all("."+v+" ."+y).removeClass(y)},restoreFormAction:function(){var a,b=this.get("searchForm");a=this.get("action"),b.setAttribute("action",a)},customizeFormAction:function(){var b,c,d;this.restoreFormAction(),b=this.get("searchForm"),c=this.get("action"),this.get("ylt")?d=c.replace(this.get("ylt"),this.get("yltCustom")):(d=";"===c[c.length-1]?c+this.get("yltCustom"):c+";"+this.get("yltCustom"),a.log("no default ylt token found on form action to replace it with customYlt","warn")),b.setAttribute("action",d)},onFormSubmission:function(c){var d,e,f,g=this,h={},i=this,k=g.get("tray"),l=this,m=this,n=this,o=0,p=m.get("mobileExpandMode");c.preventDefault(),this.get("ultEnabled")&&!this.get("_externalDS")&&n.ULT&&this.get("ult")&&this.get("ult").spaceId&&(d={pqstr:"",n_sugg:0,pos:0,query:"",pqstrl:"",qstrl:""},k&&k.len&&(o=k.len),f=this.getOrigQuery()||"",d.pqstr=f,d.pqstrl=f.length,d.n_sugg=o,"click"===c.type||"touchend"===c.type||"gesturemoveend"===c.type?(this.get("yltCustom")&&this.customizeFormAction(),d.fr2="sa-gp",d.pos=g.getSuggestPosition(c),"number"!=typeof d.pos&&(d.pos=0),e=g.getSuggestData(c)):e=i.getQuery(),"submit"===c.type&&(e===this._curSuggestion?(this.get("yltCustom")&&this.customizeFormAction(),d.fr2="sa-gp",d.pos=this._curPos,"number"!=typeof d.pos&&(a.log("ULT:error:position of click/touch of suggestion undefined","error",b),d.pos="")):(d.pqstr="",d.pqstrl="")),d.query=e||"",d.qstrl=d.query.length,n.instrumentFormSubmit(d)),k&&k.Node&&k.Node.addClass(A),a.later(j,this,function(){a.log("time for suggest markup to be removed look for : TIME_BEFORE_SUGGEST_MARKUP_IS_REMOVED","debug",b),p&&(a.log("inside Form SUbmission and now removing mobile expand","debug",b),l.removeMobileExpand()),g.removeSuggestionsMarkup()}),c.currentTarget&&(h=c.currentTarget),a.log("firing event:"+V,"debug",b),this.fire(V,{suggestionNode:h}),this._originalQuery=""},handleEventOnSuggestItem:function(a,b){var c,e,f,g,h,i=this,j=this,k=this.get(d),l=this;return c=j.getSuggestData(a),e=c.toString(),h=this.getSuggestPosition(a),g=this.getQuery(),i.setSearchBoxVal(c),b?(c+=" ",j._noRefresh=!0,k.blur().set("value",c).focus(),f={pos:h,value:c,query:g,actn:"mb_ac"},l.fireInTheHole(a,f),void this.logAutoCompletion(g,e,h)):void 0},resizeTray:function(){var b=this,c=b.get(d),f=b.get(e),g=c.get("clientWidth"),h=c.get("clientHeight"),i=c.getXY(),j=i[1]+h,k=10;this.resizeSa&&this.resizeSa.cancel(),this.resizeSa=a.later(0,this,function(){this.isWidthComputed=!1,i=c.getXY(),g=c.get("clientWidth"),(i!==this.searchBoxPos||g!==this.searchBoxWidth)&&(this.searchBoxPos=i,this.searchBoxWidth=g,j=i[1]+h,k=10,i[1]=j+k,a.log("searchBoxWidth:"+g,"debug"),a.log("searchBoxHeight:"+h,"debug"),a.log(i,"debug"),f.setStyles({width:g+"px"}),f.setXY(i))})},alignTrayDeregisteration:function(){var a=this._allSubscr,b=this,c=b.get(e);a&&a._trayAutoAlignOnResize&&a._trayAutoAlignOnResize.detach(),c.setStyles({position:"",width:"","margin-top":"",left:"",top:""})},alignTrayRegisteration:function(){var c=this,f=this._allSubscr,g=c.get(d),h=c.get(e),i=g.get("clientWidth"),j=g.get("clientHeight"),k=g.getXY(),l=k[1]+j,m=this,n=10;k[1]=l+n,a.log("searchBoxWidth:"+i,"debug",b),a.log("searchBoxHeight:"+j,"debug",b),a.log(k,"debug",b),h.setStyles({position:"absolute",width:i+"px","margin-top":"1px"}),h.setXY(k),f._trayAutoAlignOnResize=a.on("resize",m.resizeTray,a.config.win,this)},removeHighlightClasses:function(a){a&&a.currentTarget&&(a.currentTarget.removeClass(z),a.currentTarget.removeClass(y))},attachTrendingTrayLabels:function(){var b,c,d=a.one("."+w),e=a.one("."+x);d&&d.remove(),e&&e.remove(),b=a.one("."+C),b&&(d=a.Node.create("<span></span>"),d.addClass(w),d.setContent(this.get("translation")[k]),b.insertBefore(d,b)),c=a.one("."+D),c&&(e=a.Node.create("<span></span>"),e.addClass(x),e.setContent(this.get("translation")[l]),c.insertBefore(e,c))},highlightSuggestion:function(b,c,d){var e,f,g,h=c.split(/[\s|,]/),i="";for(e=0;e<h.length;e+=1)f=h[e],h[e]=h[e].replace(/[;\?,:\'\/.%\*&\\\(\)\^]/g,""),h[e]&&(i=i+f+" ");return(i=this.trimEndSpace(i))?(g=d||b,i=i.split(" "),a.Highlight.all(g,i)):b},isTrayOpen:function(){var c=this.get("tray");return c&&c.Node?(a.log("tray and tray.Node exist","debug",b),!0):(a.log("tray or tray.Node doesnt exist yet","debug",b),!1)},closeTray:function(){var a=this;a.isTrayOpen()&&a.removeSuggestionsMarkup()},buildTrayNode:function(){var b=this,c=b.get(h),d=this.get("tray");return d.Node||(d.Node=a.Node.create("<div></div>"),d.Node.addClass(u),c.append(d.Node)),d.Node},buildEmptyTray:function(){var b=a.Node.create("<ul></ul>");return b.addClass(v),b},buildTray:function(c){a.log("building TRAY","debug",b),this.buildTrayNode(),this.buildTrayContent(c)},buildTrayContent:function(c){var d,e=this.get("tray"),f=this.isTrayTypeTrending(),g=this.getQuery();d=this.getTrayHtml(c),this.fire(R),e.len>0?(e.Node.setHTML(d),this.fire(P,{trending:f,query:g,suggestionMarkup:d,firstSuggestion:this._firstSuggestion,jsonData:c})):(this.update_tabCount(),this.closeTray(),this.fire(Q,{query:g}),a.log("closed the tray, since tray.len is 0","debug",b))},buildSuggestion:function(b){var c=a.Node.create("<li>"+b+"</li>");return c},getTrayHtml:function(c){var e,f,g,h,j,k,l,s,t,u,v,w,x,y=0,z=this,A=this,B=z.getQuery(),F=this.isTrayTypeTrending(),I=0,J=this.getTray(),K=!1,L=!1,M=this.get("currentDevice"),N="desktop"===M&&!this.get("ieTillSeven")&&this.get("subAssist")&&c.sqpos&&a.Lang.isNumber(c.sqpos),O=this.getQuery(),P=this.get("enableTruncation")&&("tablet"===M||"phone"===M);if(e=c.r,v=this.getDefaultSuggArrParam(),this.get("_externalDS"))try{if(!c.results)throw a.error("results has no data, check schema and server data");v=this.get("_suggArrayParam"),e=c.results}catch(Q){a.log("error"+Q,"error"),a.log(JSON.stringify(c,null,"  "),"error")}if(f=e.length,this._offsetWidth=0,this._isWidthComputed=!1,g=this.buildEmptyTray(),J&&J.Node&&P&&J.Node.addClass(H),c&&c.l&&(x=this._setGprid(c.l.gprid)),a.log("Gprid:"+x,"debug",b),J&&(J.origLen=f,J.len=0),f>0){for(J&&J.Node&&this.computeQueryWidthOnDOM(O,J,g),f>this.get("maxSuggests")&&(f=this.get("maxSuggests")),y=0;f>y;y+=1)j=e[y][v],h=a.Escape.html(e[y][v]),0===y&&(this._firstSuggestion=h),P?(w=this.computeTruncation(h,J,g,this.get(d).get("clientWidth")),k=w.truncated?this.highlightSuggestion("..."+w.text,B,j):this.highlightSuggestion(h,B,j)):k=this.highlightSuggestion(h,B,j),N&&!this.isQueryPastSearchBox()?(this._subAssistReady=!0,t=O.substr(c.sqpos),s=j.substr(c.sqpos),s=this.trimEndSpace(s),s&&(k=this.highlightSuggestion(s,t),J&&J.Node&&!J.Node.hasClass(E)&&(J.Node.addClass(E),J.Node.addClass(G)),J&&J.Node&&!this._isWidthComputed&&(this._isWidthComputed=!0,u=O.substr(0,c.sqpos),this._offsetWidth=this.computeListItemWidth(u,J,g,!0)-this._sbxPadLeftInt-(this._listItemPadLeftInt||0)+i))):(this._subAssistReady=!1,this.removeSubAssist(J)),k&&(l=a.Node.create("<li>"+k+"</li>"),l.setAttribute("pos",y+1),l.setAttribute("data",encodeURIComponent(j)),F&&(e[y][o]!==p||K||(K=!0,l.addClass(C)),e[y][q]!==r||L||(L=!0,l.addClass(D))),this.get("webHistory")&&e[y][m]===n&&l.setAttribute("type","history"),!this.get("mobileAutoComplete")||"tablet"!==M&&"phone"!==M||A.addAutoCompleteBtn(l),I+=1,g.append(l));return J&&(J.len=I),a.log("Printing Tray markup","debug",b),a.log(g.getHTML(),"debug",b),g}return this.get("mobileExpandMode")&&J&&0===I&&""!==B?g=A.updateSuggOnNoSugg(B,g):void 0},computeQueryWidthOnDOM:function(a,b,c){return this._queryWidth=this.computeListItemWidth(a,b,c,!0),this._queryWidth},isQueryPastSearchBox:function(){var c=this._queryWidth,e=this.get(d).get("clientWidth")-this._sbxPadLeftInt;return c>e-this._sbxPadRightInt?(a.log("textWidth:"+c+"greater than sbxWidth:"+e,"debug",b),!0):!1},handleSubAssistReady:function(){var a,b,c=this.get("tray");this._subAssistReady&&(b=this.get(d).get("clientWidth"),a=c.Node.get("clientWidth"),this._offsetWidth+a>b&&(c.Node.removeClass(G),this._offsetWidth=b-c.Node.get("clientWidth")),c.Node.setStyle("left",this._offsetWidth+"px"))},removeSubAssist:function(a){a&&a.Node&&(a.Node.removeClass(E),a.Node.removeClass(G),a.Node.removeClass(F))},getSearchBoxPadding:function(a){var b,c=this.get(d),e=0;return"left"===a&&(b=c.getStyle("paddingLeft")),"right"===a&&(b=c.getStyle("paddingRight")),e=this.convertPxToInt(b)},convertPxToInt:function(a){var b=0;return a&&a.length>1&&(a=a.substr(0,a.length-2),b=parseInt(a,10)),b},computeTruncation:function(b,c,d,e){var f,g,h=a.Node.create('<li class="measurer"><b class="yui3-highlight">'+a.Escape.html(b)+"</b></li>");return c.Node.addClass(I),c.Node.addClass(J),h.addClass(K),d.append(h),c.Node.setHTML(d),g=0,h.setHTML('<li class="measurer"><b class="yui3-highlight">'+b+"</b></li>"),f=h.get("clientWidth"),e>f?(h.remove(),c.Node.removeClass(I),c.Node.removeClass(J),{text:b,truncated:!1}):(g=e>f-30?7:e>f-60?14:e>f-90?21:e>f-120?28:35,h.remove(),c.Node.removeClass(I),c.Node.removeClass(J),{text:b.substr(g),truncated:!0})},computeListItemWidth:function(b,c,d,e){var f,g=a.Node.create('<li><b class="yui3-highlight">'+a.Escape.html(b)+"</b></li>");return c.Node.addClass(I),e&&(c.Node.addClass(J),g.addClass(K)),d.append(g),c.Node.setHTML(d),void 0===this._listItemPadLeftInt&&(this._listItemPadLeftInt=this.convertPxToInt(g.getStyle("paddingLeft"))),f=c.Node.get("clientWidth"),g.remove(),c.Node.removeClass(I),e&&c.Node.removeClass(J),c.Node.setHTML(""),f},isTrendingTitleAttached:function(){return a.one("."+w)?!0:!1},isTrayTrending:function(){var c=this,e=this;return!c.isTrendingEnabled()||e.getQuery()||this.isTrayEmpty()?!1:(a.log("Trending tray is open","debug",b),c.get(d).focus(),!0)},setRenderedTrayType:function(a){this.trayType=a},getRenderedTrayType:function(){return this.trayType},isTrayTypeTrending:function(){return this.getRenderedTrayType()===s?(a.log("tray type is Trending","debug",b),!0):(a.log("tray type is normal","debug",b),!1)},removeTrayHtml:function(){var a=this.get("tray");a&&a.Node&&(a.Node.remove(!0),delete a.Node,this.fire(S))},removeSuggestionsMarkup:function(){var c=this;a.log("removing Markup for Suggestions","debug",b),this.isRenderMode(W)&&this.removeTrayHtml(),this.get("fakeBox")&&!this.get("ieTillEight")&&(this.ghost&&this.ghost.cancel(),c.resetFBox())},isRenderMode:function(a){var b=this,c=b.get("renderMode");return c===a?!0:void 0},buildSuggestionsMarkup:function(c){a.log("Building Markup for Suggestions","debug",b),this.isRenderMode(W)&&this.buildTray(c)},_defEvtRespRecvdFn:function(c){var d=this;a.log("~~~~~~~~~~~number of suggest server hits"+d._totalHitsToSuggestServer,"debug",b),a.log("~~~~~~~~~~~number of cache hits"+d._totalHitsToCache,"debug",b),c&&c.jsonData?this.buildSuggestionsMarkup(c.jsonData):a.log("no data received from suggest server","debug",b)
},_defEvtNoRespRecvdFn:function(){var c=this,d=this;a.later(100,this,function(){d.closeTray()}),a.log("~~~~~~~~~~~number of suggest server hits"+c._totalHitsToSuggestServer,"debug",b),a.log("~~~~~~~~~~~number of cache hits"+c._totalHitsToCache,"debug",b),a.log("no response received from suggest server:"+this.get("baseUrl"),"debug",b)},_defEvtSuggestMarkupRendered:function(c){a.log("Suggest has been attached to DOM: RENDER complete","debug",b);var d=this,e=this.get("tray"),f=this.get("branding"),g=this,h=this,i=this.get("mobileExpandMode"),j=this.isTrendingEnabled();return j||""!==h.getQuery()?(this.handleSubAssistReady(),e&&e.Node&&(c.trending?(this.attachTrendingTrayLabels(e.Node),e.Node.setAttribute("type",s)):e.Node.setAttribute("type",t),f&&e.Node.append('<div class="'+L+" "+f.mode+' ">'+f.label+"</div>")),this.fire(N,{mobileExpandMode:i}),void(i&&g.widenTray())):void d.closeTray()},addNewSuggestion:function(c){var d,e=this.getTray(),f=c.markup||"",g=a.one("."+v),h=c.suggestionText||"";a.log("adding new suggestion","debug",b),this.buildTrayNode(),g||(a.log("Building empty tray","debug",b),g=this.buildEmptyTray(),e.Node.setHTML(g)),e&&e.Node&&g&&(a.log("tray and tray.Node and trayListContainer exist","debug",b),d=a.Node.create('<li class="'+B+'">'+f+"</li>"),d.setAttribute("data",encodeURIComponent(h)),c.prepend?g.prepend(d):g.append(d))}})},"0.0.1",{requires:["search-assist-aria-plugin","search-assist-config-panel-plugin","search-assist-history-suggestions-plugin","search-assist-smw-suggestions-plugin","search-assist","search-assist-core","search-assist-linktrack","search-assist-navigate","intl"]}),YUI.add("search-assist-ult",function(a){"use strict";function b(a){var b,c,d,e,f,g,h,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-",j="",k=a.length,l=0;do b=a.charCodeAt(l++),c=a.charCodeAt(l++),d=a.charCodeAt(l++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),j+=i.charAt(e)+i.charAt(f)+i.charAt(g)+i.charAt(h);while(k>l);return j}function c(a){var b,c;for(b=0,c=a.length;c>b;b++)if(a.charCodeAt(b)<32)return!0;return!1}var d=a.Lang,e=a.namespace("SA");e.ULT||(e.ULT={}),a.mix(e.ULT,{SRC_SPACEID_KEY:"_S",DEFAULT_BEACON_URL:"http://geo.yahoo.com/t",beacon:function(a){var b=this.DEFAULT_BEACON_URL,c=this.instrument(b,a)+"?t="+Math.random(),d=new Image;d.onload=d.onerror=function(){d.onload=d.onerror=null,d=null},d.src=c},instrument:function(f,g){var h,i,j="",k="",l="_r",m=[],n=[];if(!d.isObject(g))return f;if(!g[e.ULT.SRC_SPACEID_KEY]){if(!a.config.i13n||!a.config.i13n.spaceid)return f;g[e.ULT.SRC_SPACEID_KEY]=a.config.i13n.spaceid}return g[l]=2,i=0,a.each(g,function(a,b){if(!d.isString(a))try{a=a.toString()}catch(e){return f}return b.length<1||b.length>8||-1!==b.indexOf(" ")||c(b)||c(a)?(m=[],f):void(m[i++]=b)}),m.length?(m=m.sort(),i=0,a.each(m,function(a){var b=g[a];n[i++]=a+j+b}),h=n.join(k),h.length<1||h.length>1024?f:(h=";_ylc="+b(h),i=f.indexOf("/*"),-1===i&&(i=f.indexOf("/?")),-1===i&&(i=f.indexOf("?")),-1===i?f+h:f.substr(0,i)+h+f.substr(i))):f}})},"0.0.1",{requires:["event-delegate","querystring-stringify"]}),YUI.add("search-assist",function(a,b){"use strict";var c=a.namespace("Client-Side-Search-Assist"),d="tray",e=4,f=!1,g=!1,h=!1,i=!1,j=!1,k=!1,l=!1,m=!0,n=d,o="desktop",p=!0,q=!1,r="web",s="us",t=0,u=null,v=null,w=null,x=null,y=!1,z="en-US",A=0,B="k",C="search.yahoo.com",D=!1,E="searchBoxContainer",F="searchForm",G="sa-sbx-container",H="sa",I="lowlight",J="sa-device",K="sa-skin",L="mobile-expand-sbx-wrapper",M="search-assist-form-wrapper",N="search.yahoo.com",O="sugg",P="gossip",Q="ss",R=3,S=!0,T={bcrumb:(new Date).getTime(),crumb:(new Date).getTime(),maxSuggestions:R,highlightHistory:S},U=3,V={crumb:(new Date).getTime(),maxSuggestions:U},W={},X={label:"Search Suggest by Yahoo",mode:"regular"},Y=!1,Z={spaceId:u,csrcpvid:v,vtestid:w,mtestid:x},$={lat:null,lon:null,woeid:null},_={expandMode:!1,skin:"phone",disablePlaceHolder:!1},ab={expandMode:!1,skin:"desktop",disablePlaceHolder:!0},bb={expandMode:!1,skin:"tablet",disablePlaceHolder:!0},cb={desktop:ab,phone:_,tablet:bb},db={RELATED_TITLE:"Related Searches",TRENDING_NOW_TITLE:"Trending Searches",MOBILE_SEARCH_FOR_TITLE:"Search For",MOBILE_EXIT_BUTTON_TITLE:"cancel",MOBILE_END_PIECE_TITLE:"Press Enter To Search",MOBILE_PLACEHOLDER_TITLE:"Search"},eb={US:!0,AR:!0,AU:!0,BR:!0,CA:!0,DE:!0,ES:!0,FR:!0,QC:!0,HK:!0,ID:!0,IN:!0,IT:!0,KR:!0,MX:!0,MY:!0,NZ:!0,PH:!0,SG:!0,TH:!0,TW:!0,UK:!0,ESPANOL:!0,MALAYSIA:!0,VN:!0,AT:!0,CH:!0,CL:!0,CO:!0,DK:!0,FI:!0,NL:!0,NO:!0,PE:!0,RU:!0,SE:!0,VE:!0},fb={"en-US":{web:0,sports:102,image:103,news:104,directory:108,video:112,audio:115,finance:596,"autos-vertical":609,"autos-related":610,"autos-also-try":611,"music-web-backfill":1002,shine:1003,omg:1004,games:1005,dictionary:1306,answers:1307,"answers-vertical":1317,"movie-vertical":1308,"movie-web-backfill":1308,"shopping-vertical":1312},"es-AR":{web:0,image:287,news:288,video:292,blog:359,answers:1307,"answers-vertical":1317},"de-AT":{web:0},"en-AU":{web:0,image:231,news:232,directory:234,video:236,lifestyle:1101,sports:1102,tv:1103,finance:1104,movie:1105,recipe:1106,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"pt-BR":{web:0,image:244,news:245,video:249,answers:1307,"answers-vertical":1317},"en-CA":{web:0,image:396,news:397,directory:399,video:401,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"fr-CA":{web:0,image:411,news:412,directory:414,video:416,answers:1307,"answers-vertical":1317},"fr-CH":{web:0},"it-CH":{web:0},"de-CH":{web:0},"es-CL":{web:0},"es-CO":{web:0},"de-DE":{web:0,audio:132,image:350,news:351,directory:352,local:354,video:356,mobile:362,answers:1307,"answers-vertical":1317},"da-DK":{web:0},"es-US":{web:0,image:382,news:383,directory:385,video:387,answers:1307,"answers-vertical":1317},"es-ES":{web:0,image:302,news:303,directory:304,local:306,video:308,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"se-FI":{web:0},"sv-FI":{web:0},"fi-FI":{web:0},"fr-FR":{web:0,image:318,news:319,directory:320,local:322,video:324,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"zh-Hant-HK":{web:0,blog:122,news:134,forum:135,image:147,audio:148,directory:149,knowledge:152,video:153,"shopping-vertical":1301,dictionary:1306},"id-ID":{web:0,image:467,news:468,audio:469,directory:470,video:472,answers:1307,"answers-vertical":1317},"en-IN":{web:0,image:426,news:427,directory:429,local:431,video:433,answers:1307,"answers-vertical":1317},"it-IT":{web:0,image:366,news:367,directory:368,local:370,video:372,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"es-MX":{web:0,image:272,news:273,video:277,mobile:283,answers:1307,"answers-vertical":1317},"en-MY":{web:0,image:453,news:454,directory:456,video:458,blog:461,answers:1307,"answers-vertical":1317},"ms-MY":{web:0,image:453,news:454,directory:456,video:458,blog:461,answers:1307,"answers-vertical":1317},"nl-NL":{web:0},"se-NO":{web:0},"nb-NO":{web:0},"nn-NO":{web:0},"en-NZ":{web:0,image:531,news:532,video:536,lifestyle:1201,sports:1202,finance:1203,movie:1204,"movie-web-backfill":1308,recipe:1205,answers:1307,"answers-vertical":1317},"qu-PE":{web:0},"es-PE":{web:0},"en-PH":{web:0,image:482,news:483,directory:485,video:487,answers:1307,"answers-vertical":1317},"ru-RU":{web:0},"tt-RU":{web:0},"se-SE":{web:0},"su-SE":{web:0},"en-SG":{web:0,image:216,news:217,directory:219,video:221,answers:1307,"answers-vertical":1317},"th-TH":{web:0,image:497,news:498,video:502,answers:1307,"answers-vertical":1317},"zh-Hant-TW":{web:0,image:183,news:184,audio:185,directory:186,knowledge:189,video:190,blog:193,academia:195,mobile:197,wretch:548,"shopping-srp-vertical":1301,"shopping-mall-vertical":1302,"shopping-store-vertical":1303,"auction-vertical":1304,"service-vertical":1305,"shopping-category-vertical":1322,"shopping-store-category-vertical":1323,"auction-category-vertical":1324,dictionary:1306},"cy-GB":{web:0,audio:131,image:334,news:335,directory:336,local:338,video:340,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"en-GB":{web:0,audio:131,image:334,news:335,directory:336,local:338,video:340,"movie-vertical":1308,"movie-web-backfill":1308,answers:1307,"answers-vertical":1317},"es-VE":{web:0},"vi-VN":{web:0,image:513,news:514,video:518,blog:521,answers:1307,"answers-vertical":1317}};fb["zh-HK"]=fb["zh-Hant-HK"],fb["zh-TW"]=fb["zh-Hant-TW"],c=function(){c.superclass.constructor.apply(this,arguments)},a.mix(c,{NAME:"SearchAssist",ATTRS:{property:{value:r,setter:function(a){return void 0===this.getPubId(a)?r:a}},translation:{valueFn:function(){return db},setter:function(b){return a.mix(b,db),b}},pubid:{setter:function(a){return a},valueFn:function(){var a,b=this.get("property");return a=this.getPubId(b),"undefined"!==a?a:t}},ylt:{value:null},yltCustom:{value:null},action:{valueFn:function(){if(this.get("yltCustom")){var a,b=this.get("searchForm").getAttribute("action"),c=b.split(/[;\?]+/),d=/_ylt/gi;for(this.set("action",b),a=0;a<c.length;a+=1)d.test(c[a])&&this.set("ylt",c[a]);return b}return""}},reverseHighlight:{value:p},market:{value:s},dataSrc:{setter:function(b){var c=b.url,d=this;if(!c)throw a.error("No url inside dataSrc config param");return a.log("dataSrc.url: "+b.url,"debug"),d.flushCache(),b},valueFn:function(){this._newProperty=this.get("property");var b=this.intlTheUrl();return a.log("valueFn"+b,"debug"),{url:b,params:null}}},baseUrl:{getter:function(){return this.get("dataSrc").url}},_externalDS:{valueFn:function(){return this.get("dataSrc").params?this.get("dataSrc"):!1},getter:function(){return this.get("dataSrc").params?this.get("dataSrc"):!1}},_suggArrayParam:{value:B},quietMode:{value:q,setter:function(b){return a.Lang.isBoolean(b)?b:void 0}},allowCache:{value:Y,setter:function(b){return a.Lang.isBoolean(b)?b:void 0}},cancelButton:{value:!1},maxSuggests:{value:e},searchBox:{initOnly:!0,setter:function(b){var c=a.one(b);return c||a.error("Invalid Search Box id specified"+b),"off"!==c.getAttribute("autocomplete")&&c.setAttribute("autocomplete","off"),c.setAttribute("autocorrect","off"),c.setAttribute("autocapitalize","off"),c.setStyles({"-webkit-tap-highlight-color":"transparent"}),c}},searchForm:{valueFn:function(){return this.get("searchBox").get("form")},setter:function(b){var c=a.one(b);return c||a.error("not a valid search form node"+b),c},getter:function(){return this.get("searchBox").get("form")}},preventFormSubmit:{value:!1},hostNodeToAttach:{setter:function(b){return a.one(b)?a.one(b):null}},fakeBox:{value:y},fakeBoxNode:{getter:function(){return a.one("#fakeBox")}},fakeBoxHintNode:{getter:function(){return a.one("#fakeBoxHint")}},searchBoxContainer:{valueFn:function(){var b,c=a.Node.create("<div></div>");return c.generateID(),b=this.get("hostNodeToAttach"),b||(b=this.get(F)),b.append(c),c.addClass(G),c}},gossipParams:{value:W,setter:function(a){return a}},saFormWrapper:{valueFn:function(){return this.get("searchForm").wrap('<div class="'+M+'"></div>'),a.one("."+M)}},saContainer:{valueFn:function(){var b=a.Node.create("<div></div>");return b.generateID(),this.get(E).append(b),b.addClass(H),this.get("reverseHighlight")&&b.addClass(I),b}},ieTillFive:{valueFn:function(){return a.UA.ie>0&&a.UA.ie<6?!0:!1}},ieTillSix:{valueFn:function(){return a.UA.ie>0&&a.UA.ie<7?!0:!1}},ieTillSeven:{valueFn:function(){return a.UA.ie>0&&a.UA.ie<8?!0:!1}},ieTillEight:{valueFn:function(){return a.UA.ie>0&&a.UA.ie<9?!0:!1}},allIe:{valueFn:function(){return a.UA.ie>0?!0:!1}},gecko:{valueFn:function(){return a.UA.gecko>0?!0:!1}},mbxWrapperNode:{initOnly:!0,setter:function(b){return a.one(b)}},appId:{valueFn:function(){return a.config.win.location.hostname||C},setter:function(a){return a}},exitScreenButton:{value:!1},sendBCookie:{value:m,setter:function(b){return a.Lang.isBoolean(b)?b:void 0}},bcookie:{valueFn:function(){return encodeURIComponent(a.Cookie.get("B"))||encodeURIComponent(a.Cookie.get("BX"))||null}},smw:{lazyAdd:!1,setter:function(b){return b?(this._smwPlugged||(this._smwPlugged=!0,this.plug(a.SEARCHASSIST.SmwSuggestionsPlugin)),a.mix(b,V),b):(this._smwPlugged=!1,this.unplug(a.SEARCHASSIST.SmwSuggestionsPlugin),!1)}},webHistory:{lazyAdd:!1,setter:function(b){return b?(!this._webHistoryPlugged&&b.highlightHistory&&(this._webHistoryPlugged=!0,this.plug(a.HistorySuggestionsPlugin)),a.mix(b,T),b):(this._webHistoryPlugged=!1,this.unplug(a.HistorySuggestionsPlugin),!1)}},branding:{setter:function(b){return b?(a.mix(b,X),b):!1}},ariaPlug:{value:!1},renderMode:{value:n},enableTrending:{value:f,setter:function(a){return this._origETVal=a,a},getter:function(){return this.checkUrlSupportForEmptyQuery()&&this._origETVal}},autoAlign:{value:g},anyKeySearch:{value:i},backspaceBehaviorNative:{value:j},replaceQueryOnFocus:{value:k},noSpaceOnFocus:{value:l},disablePlaceHolder:{value:!1,getter:function(){return this.get("device")[this.get("currentDevice")].disablePlaceHolder}},configPanel:{value:null},skin:{getter:function(){return this.get("device")[this.get("currentDevice")].skin}},currentDevice:{valueFn:function(){var b;return b=a.UA.mobile?a.UA.iphone>0?"phone":"tablet":"desktop"},setter:function(b){return"phone"!==b&&"tablet"!==b&&"desktop"!==b?(a.log("invalid device type specified"+b+".device type has to be phone tablet or desktop","error"),o):(this.get("device")[b].expandMode===!0&&this.createMobileWrapper(),b)}},mobileExpandMode:{value:!1,getter:function(){return this.get("device")[this.get("currentDevice")].expandMode}},device:{valueFn:function(){return cb},setter:function(b){return a.mix(b,cb),a.mix(b.phone,_),a.mix(b.desktop,ab),a.mix(b.tablet,bb),b}},ultEnabled:{setter:function(b){return a.Lang.isBoolean(b)?b:void 0},valueFn:function(){return!1}},ult:{setter:function(b){return a.mix(b,Z),a.Lang.isString(b.spaceId)?b:Z}},enableTruncation:{value:!1},mobileAutoComplete:{value:!1},logAutoComplete:{value:!1},minKey:{setter:function(b){return a.Lang.isNumber(b)&&b>=0?b:(a.log("minKey can take numbers ranging [0, )","error"),A)},value:A},subAssist:{value:h},lang:{value:z,setter:function(a){return a}},https:{value:D,setter:function(a){return a}},geo:{valueFn:function(){return $},setter:function(b){return a.mix(b,$),b}},extraUltParams:{value:{},setter:function(b){return a.Lang.isObject(b)?b:(a.log("erroneous ultExtraParams provided, make sure its an object","error"),{})}}}}),a.SEARCHASSIST=a.extend(c,a.Base,{initializer:function(c){var d=this;a.log("instantiating SearchAssist","debug",b),c=c||{},a.log("cfg-Obj:","debug",b),a.log(c,"debug"),this._allSubscr={},this.get("ult")&&this.set("ultEnabled",!0),this.setDeviceClass(),this.get("mobileExpandMode")===!0&&this.createMobileWrapper(),this._isCookieSetForSAActive()===!0?this.set("quietMode",!1):this.set("quietMode",!0),this.on("quietModeChange",d.handleQuietModeChange),this.on("autoAlignChange",d.handleAutoAlignChange),this.on("propertyChange",d.handlePropertyChange),this.after("langChange",d.handleLangChange),this.after("webHistoryChange",d.updateDataSrcUrl),this.after("httpsChange",d.updateDataSrcUrl),this.after("ultChange",d.setUltStatus),this._origProperty=this.get("property"),this._newProperty=this.get("property")},setUltStatus:function(a){a.newVal?this.set("ultEnabled",!0):this.set("ultEnabled",!1)},setDeviceClass:function(){var b=this.get("currentDevice"),c=this.get("skin"),d=a.one("html");d&&(d.removeClass(J+"-phone"),d.removeClass(J+"-tablet"),d.removeClass(J+"-desktop"),d.addClass(J+"-"+b),d.removeClass(K+"-phone"),d.removeClass(K+"-tablet"),d.removeClass(K+"-desktop"),d.addClass(K+"-"+c))},checkUrlSupportForEmptyQuery:function(){return this._urlSupportsTrending||this.get("dataSrc")&&this.get("dataSrc").supportsEmptyQuery?!0:!1},getDefaultSuggArrParam:function(){return B},_isCookieSetForSAActive:function(){var b=a.config.doc.cookie.match(/(?:^|\s*;\s*)SP=(?:[^&]*&)?a=(\d)(?:&|;)?/);return b&&"0"===b[1]?!1:!0},_detachAllSubscriptions:function(){var c,d=this._allSubscr;if(d)for(c in d)d.hasOwnProperty(c)&&(a.log("detaching subscription: "+c,"debug",b),d[c].detach())},updateDataSrcUrl:function(){var a=this.intlTheUrl();a&&this.set("dataSrc",{url:a})},getPubIdForProp:function(c,d){var e=fb[d];return e&&void 0!==e[c]?e[c]:(a.log("No PubId found for lang="+d+" and property="+c,"warn",b),t)},handleLangChange:function(a){var b;this.updateDataSrcUrl(a),b=this.getPubIdForProp(this._newProperty,this.get("lang")),this.set("pubid",b)},handlePropertyChange:function(c){var d=c.newVal,e=this,f=this.getPubId(d);void 0!==f?(this.set("pubid",f),e.flushCache()):(f=this.getPubId(this._origProperty),a.log("no Pubid for the given property:"+d,"warn",b),a.log("defaulting to pubid for original property:"+this._origProperty,"warn",b),void 0!==f?(this.set("pubid",f),e.flushCache()):(a.log("defaulting to pubid"+t,"warn",b),this.set("pubid",t))),this._newProperty=d,this.handleLangChange()},handleAutoAlignChange:function(b){var c=b.newVal,d=this._allSubscr,e=this;c===!1&&(a.log("autoAlign has been set to false.. deregistering it","debug"),e.alignTrayDeregisteration()),c===!0&&(a.log("autoAlign has been set to true.. reregistering it","debug"),d&&!d._autoAlignRegistered&&e.alignTrayRegisteration())},handleQuietModeChange:function(c){var d=c.newVal;d!==!1||this._initDone||(this._initDone=!0,a.log("reattach all subscriptions","debug",b),this.coreInit(),this.clientInit(),this.navInit(),this.trayInit()),d===!0&&(a.log("detach all subscriptions",b),this.closeTray(),this._detachAllSubscriptions(),this._initDone=!1)},isTrendingEnabled:function(){return this.get("enableTrending")},createMobileWrapper:function(){a.one("."+L)||(this.get("searchBox").wrap('<div class="'+L+'"></div'),this.set("mbxWrapperNode","."+L))},getPubId:function(c){var d=this,e=d.get("lang"),f=fb[e];return f&&"undefined"!==f[c]?f[c]:(a.log("no valid pubid found for lang="+e+"property="+c,"warn",b),a.log("using default pubid","warn",b),t)},intlTheUrl:function(){return this.setMarket(),this.langifySuggestUrl()},langifySuggestUrl:function(){var c,d,e,f=this.get("lang"),g=this.get("market"),h=this._newProperty;switch(h&&(h=h.toLowerCase()),d="http"+(this.get("https")===!0?"s":""),c=d+"://"+g+"."+N+"/"+O+"/"+P+"/gossip-"+("malaysia"===g?"my":g),this._urlSupportsTrending=!1,f){case"en-US":switch(e=d+"://"+N+"/"+O+"/",h){case"web":c=e+P+"/gossip-us-ura",this._urlSupportsTrending=!0;break;case"sports":case"image":case"news":case"directory":case"video":case"audio":case"shine":case"omg":case"games":case"finance":c=e+Q+"/gossip-us_ss";break;case"autos-vertical":case"movie-vertical":case"shopping-vertical":case"dictionary":c=e+P+"/gossip-us-vertical_ss";break;case"answers-vertical":case"answers":c=e+Q+"/gossip-us_ss-vertical_ss";break;case"autos-related":c=e+P+"/gossip-us-seaview";break;case"autos-also-try":c=e+P+"/gossip-us-falcon";break;case"music-web-backfill":c=e+P+"/gossip-us-uh";break;case"movie-web-backfill":c=e+P+"/gossip-us-uh_ss";break;default:c=e+P+"/gossip-us-ura",this._urlSupportsTrending=!0}break;case"es-AR":case"pt-BR":case"de-DE":case"id-ID":case"en-IN":case"es-MX":case"en-MY":case"ms-MY":case"en-PH":case"en-SG":case"th-TH":case"vi-VN":("answers"===h||"answers-vertical"===h)&&(c+="-vertical_ss");break;case"fr-CA":c=d+"://"+g+"."+N+"/"+O+"/"+P+"/gossip-ca_fr",("answers"===h||"answers-vertical"===h)&&(c+="-vertical_ss");break;case"en-AU":case"en-CA":case"es-ES":case"fr-FR":case"it-IT":("movie-vertical"===h||"answers"===h||"answers-vertical"===h)&&(c+="-vertical_ss"),"movie-web-backfill"===h&&(c+="-uh_ss");break;case"en-NZ":("answers"===h||"answers-vertical"===h)&&(c+="-vertical_ss"),"movie-web-backfill"===h&&(c+="-uh_ss");break;case"zh-HK":case"zh-Hant-HK":switch(h){case"web":c+="-ura",this._urlSupportsTrending=!0;break;case"dictionary":case"shopping-vertical":c+="-vertical_ss"}break;case"zh-TW":case"zh-Hant-TW":switch(h){case"web":c+="-ura",this._urlSupportsTrending=!0;break;case"dictionary":case"shopping-srp-vertical":case"shopping-mall-vertical":case"shopping-store-vertical":case"auction-vertical":case"service-vertical":case"shopping-category-vertical":case"shopping-store-category-vertical":case"auction-category-vertical":c+="-vertical_ss"}break;case"en-GB":case"cy-GB":switch(h){case"web":c+="-ura",this._urlSupportsTrending=!0;break;case"movie-vertical":case"answers":case"answers-vertical":c+="-vertical_ss";break;case"movie-web-backfill":c+="-uh_ss"}break;case"es-US":c=d+"://"+g+"."+N+"/"+O+"/"+P+"/gossip-e1",("answers"===h||"answers-vertical"===h)&&(c+="-vertical_ss");break;default:a.log("default case, no special url treatment for this property and language","info")}return a.log("gossip url:"+c,"debug",b),c+="/"},setMarket:function(){function c(c){return eb[c]?!0:(a.log("invalid market:"+c,"warn",b),a.log("available markets:"+eb,"warn"),!1)}var d=this.get("lang"),e=d.split("-"),f="",g=e.length;a.Lang.isArray(e)&&g>0&&e[g-1]&&(f=e[g-1]),"fr-CA"===d&&(f="QC"),("en-GB"===d||"cy-GB"===d)&&(f="UK"),"es-US"===d&&(f="ESPANOL"),("en-MY"===d||"ms-MY"===d)&&(f="MALAYSIA"),c(f)||(f=s),this.set("market",f.toLowerCase())}})},"0.0.1",{requires:["base","cookie","intl"]});;